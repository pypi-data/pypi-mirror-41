webpackJsonp([13],{LW7d:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s("mw3O"),a=s.n(r),i={name:"Setting",data:function(){return{tab_cur:"sys_config",form:{mysql_driver:"",etcd_driver:"sqlite:////etc/sumeru.db",redis_driver:"",smtp_host:"127.0.0.1",smtp_port:"25",smtp_user:"sumeru",smtp_pass:"",mail_list:"admin@arkpy.com,guest@arkpy.com"}}},created:function(){this.getSetting()},methods:{saveSetting:function(){var t=this;this.$confirm("是否确认此操作?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.post("/api/system/settings",a.a.stringify(t.form)).then(function(e){1==e.data.status?t.$message.success("配置保存成功!"):t.$message.error(e.data.msg)})})},getSetting:function(){var t=this;this.$axios.get("/api/system/settings").then(function(e){t.form=e.data.result})},clearTask:function(){var t=this;this.$confirm("是否确认此操作,此操作会造成数据丢失!!!无法恢复!!!慎重执行!!!","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.post("/api/system/op",a.a.stringify({OP:"CLEAR_TASK_INS"})).then(function(e){1==e.data.status?t.$message.success("操作成功"):t.$message.error("操作失败")})})},initDB:function(){var t=this;this.$confirm("是否确认此操作,此操作会造成数据丢失!!!无法恢复!!!慎重执行!!!","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.post("/api/system/op",a.a.stringify({OP:"INIT_DB"})).then(function(e){1==e.data.status?t.$message.success("操作成功"):t.$message.error("操作失败")})})},clearMQ:function(){var t=this;this.$confirm("是否确认此操作,此操作会造成数据丢失!!!无法恢复!!!慎重执行!!!","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.post("/api/system/op",a.a.stringify({OP:"CLEAR_TASK_QUEUE"})).then(function(e){1==e.data.status?t.$message.success("操作成功"):t.$message.error("操作失败")})})},testMail:function(){var t=this;this.$confirm("是否确认此操作?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.post("/api/system/op",a.a.stringify({OP:"SEND_EMAIL"})).then(function(e){1==e.data.status?t.$message.success("操作成功"):t.$message.error("操作失败")})})}}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"crumbs"},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[s("i",{staticClass:"el-icon-date"}),t._v(" 系统\n      ")]),t._v(" "),s("el-breadcrumb-item",[s("i",{staticClass:"el-icon-configuration iconfont_no_margin"}),t._v(" 系统设置\n      ")])],1)],1),t._v(" "),s("div",{staticClass:"container"},[s("el-tabs",{model:{value:t.tab_cur,callback:function(e){t.tab_cur=e},expression:"tab_cur"}},[s("el-tab-pane",{attrs:{label:"系统配置",name:"sys_config"}},[s("div",{staticClass:"form-box"},[s("el-form",{ref:"form",attrs:{model:t.form,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"ETCD配置"}},[s("el-input",{attrs:{placeholder:"示例  [('192.168.1.1', 2379), ('192.168.1.2', 2379), ('192.168.1.3', 2379)]"},model:{value:t.form.etcd_driver,callback:function(e){t.$set(t.form,"etcd_driver",e)},expression:"form.etcd_driver"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"数据库URI"}},[s("el-input",{attrs:{placeholder:"mysql://username:password@ip:port/database"},model:{value:t.form.db_driver,callback:function(e){t.$set(t.form,"db_driver",e)},expression:"form.db_driver"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"消息队列URI"}},[s("el-input",{attrs:{placeholder:"redis://:password@host:port/db"},model:{value:t.form.redis_driver,callback:function(e){t.$set(t.form,"redis_driver",e)},expression:"form.redis_driver"}})],1),t._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:t.saveSetting}},[t._v("保存")])],1)],1)],1)]),t._v(" "),s("el-tab-pane",{attrs:{label:"邮箱配置",name:"email_config"}},[s("div",{staticClass:"form-box"},[s("el-form",{ref:"form",attrs:{model:t.form,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"SMTP服务器"}},[s("el-input",{model:{value:t.form.smtp_host,callback:function(e){t.$set(t.form,"smtp_host",e)},expression:"form.smtp_host"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"SMTP端口号"}},[s("el-input",{model:{value:t.form.smtp_port,callback:function(e){t.$set(t.form,"smtp_port",e)},expression:"form.smtp_port"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"SMTP用户"}},[s("el-input",{model:{value:t.form.smtp_user,callback:function(e){t.$set(t.form,"smtp_user",e)},expression:"form.smtp_user"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"SMTP密码"}},[s("el-input",{attrs:{type:"password"},model:{value:t.form.smtp_pass,callback:function(e){t.$set(t.form,"smtp_pass",e)},expression:"form.smtp_pass"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"邮件列表"}},[s("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:t.form.mail_list,callback:function(e){t.$set(t.form,"mail_list",e)},expression:"form.mail_list"}})],1),t._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:t.testMail}},[t._v("测试邮件")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.saveSetting}},[t._v("保存")])],1)],1)],1)]),t._v(" "),s("el-tab-pane",{attrs:{label:"管理员操作",name:"admin_op"}},[s("el-button",{attrs:{type:"primary"},on:{click:t.initDB}},[t._v("初始化数据库")]),t._v(" "),s("el-button",{staticClass:"handle-del mr10",attrs:{type:"danger"},on:{click:t.clearTask}},[t._v("清空所有任务实例")]),t._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:t.clearMQ}},[t._v("清空消息队列")])],1)],1)],1)])},staticRenderFns:[]},o=s("VU/8")(i,n,!1,null,null,null);e.default=o.exports}});