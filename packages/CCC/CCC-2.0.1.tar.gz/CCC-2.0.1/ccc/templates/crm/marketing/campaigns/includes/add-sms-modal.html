{% load static %}
<div id="SMSModal" class="uk-flex-top" data-uk-modal="stack:true">
  <div class="uk-modal-dialog uk-modal-body uk-margin-auto-vertical uk-width-1-2@m">
    <h4 class="uk-modal-title uk-text-center modal-header uk-margin">Add SMS</h4>
    <a class="uk-modal-close uk-position-absolute uk-position-top-right uk-margin uk-margin-right uk-text-danger" type="button">X</a>
    <form id="SMSModalForm" class="uk-grid-small" uk-grid @submit.prevent="handleSMSForm">
      <input type="hidden" name="user" value="{{ request.user.id }}">
      <div class="uk-width-1-2@m">
        <div class="uk-form-controls">
          <select class="srm-input" id="" name="">
            <option>Contact</option>
          </select>
        </div>
      </div>
      <div class="uk-width-1-2@m">
        <div class="uk-form-controls">
          <select class="srm-input" id="" @change="copyPasteInitChanged">
            <option value="">-- select --</option>
            <option v-for="(f, index) in fillInFields" :value="f.key" :key="index">[[ f.value ]]</option>
          </select>
        </div>
      </div>
      <div class="uk-margin-medium-top uk-width-1-2@m">
        <label class="uk-form-label Label" for="form-stacked-text">Copy and paste this into SMS</label>
        <div class="uk-form-controls input-box uk-inline uk-flex">
          <a class="uk-form-icon uk-form-icon-flip" href="#" uk-icon="icon: copy" onclick="copyToClipBoard(event,'#copytext2');"></a>
          <input class="srm-input" id="copytext2" type="text" placeholder="{{contact_phone}}" name="" :value="copy" readonly>
        </div>
      </div>
      <div class="uk-margin-medium-top uk-width-1-2@m">
        <label class="uk-form-label Label" for="form-stacked-text">Sample phone</label>
        <div class="uk-form-controls input-box">
          <input class="srm-input" id="form-stacked-text" v-model="campaign.sample_no" type="text" name="sample_no" placeholder="Enter to receive sample text messaage">
        </div>
        <small class="uk-text-danger uk-text-small" v-if="errors.sample_no">[[ errors.sample_no[0] ]]</small>
      </div>
      <div class="uk-margin-medium-top uk-width-1-1@m">
        <label class="uk-form-label Label" for="form-stacked-text">SMS text</label>
        <div class="uk-form-controls input-box">
          <textarea class="srm-input" :maxlength="max_sms_char_count" id="form-stacked-text" v-model="campaign.text" type="text" placeholder="Text" name="text"></textarea>
        </div>
        <div class="uk-text-meta uk-margin-small-top uk-margin-small-bottom">
          [[ charLeft ]] left ([[smsCount]] unit)
        </div>
        <small class="uk-text-danger uk-text-small" v-if="errors.text">[[ errors.text[0] ]]</small>
      </div>

      {% if not is_follow_up %}
        <div class="uk-margin-medium-top uk-width-1-2@m">
          <label class="uk-form-label Label" for="form-stacked-text">Set the delay</label>
          <div class="uk-form-controls input-box">
            <select class="srm-input" name="delay_type" v-model="delay_type">
              <option :value="key" v-for="(value, key) in delayTypes">[[ value ]]</option>
            </select>
          </div>
          <small class="uk-text-danger uk-text-small" v-if="errors.delay_type">[[ errors.delay_type[0] ]]</small>
        </div>

        <div class="uk-margin-medium-top uk-width-1-2@m" v-show="delayTypeCanEnterDuration">
          <label class="uk-form-label Label" for="form-stacked-text">Delay Duration (in [[ delayTypes[delay_type] ]])</label>
          <div class="uk-form-controls input-box">
            <input class="srm-input" id="form-stacked-text" name="delay_value" type="number" placeholder="Enter delay duration" v-model="delay_value">
          </div>
          <small class="uk-text-danger uk-text-small" v-if="errors.delay_value">[[ errors.delay_value[0] ]]</small>
        </div>

        <div class="uk-margin-medium-top uk-width-1-2@m" v-show="delayTypeIsDateScheduled">
          <label class="uk-form-label Label" for="form-stacked-text">Scheduled Date</label>
          <div class="uk-form-controls input-box">
            <input class="srm-input flat-datepicker" name="trigger_date" :data-initial="trigger_date" id="form-stacked-text" @change="setSendAt" placeholder="Enter scheduled date">
          </div>
          <small class="uk-text-danger uk-text-small" v-if="errors.trigger_date">[[ errors.trigger_date[0] ]]</small>
        </div>
      {% endif %}

      <div v-if="test_error" data-uk-alert class="uk-alert uk-alert-danger uk-width-1-1">[[ test_error ]]</div>
      <div v-if="errors.non_field_errors" data-uk-alert class="uk-alert uk-alert-danger uk-width-1-1">[[ errors.non_field_errors[0] ]]</div>

      <div class="uk-margin-small-top uk-width-1-1 uk-flex uk-flex-row uk-flex-center uk-padding-small">
        <button class="srm-button srm-button-primary-outline srm-button-large uk-margin-left" @click.prevent="handleTestSMS">Test</button>
        <button type="submit" class="srm-button srm-button-primary-outline srm-button-large uk-margin-medium-left">
          <span v-if="!isCreating">Save</span>
          <span v-else data-uk-spinner class="srm-text-primary"></span>
        </button>
      </div>
    </form>
  </div>
</div>
