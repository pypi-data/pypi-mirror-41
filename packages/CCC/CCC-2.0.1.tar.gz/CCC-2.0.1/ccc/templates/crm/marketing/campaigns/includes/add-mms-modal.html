{% load static %}
<!--This is the Add MMS Modal-->

<div id="MMSModal" class="uk-flex-top" uk-modal="stack:true">
  <div class="uk-modal-dialog uk-modal-body uk-margin-auto-vertical uk-width-1-3@m">
    <form id="MMSModalForm" action="" @submit.prevent="handleMMSForm" method="post" enctype="multipart/form-data">
      <h4 class="uk-modal-title uk-text-center modal-header">Add MMS</h4>
      <small class="uk-text-center uk-display-block uk-text-primary"><span data-uk-icon="info"></span> Total media <i>(images + video)</i> size allowed is 5MB</small>
      <a class="uk-modal-close uk-position-absolute uk-position-top-right uk-margin uk-margin-right uk-text-danger" type="button">X</a>
      <input type="hidden" name="user" value="{{ request.user.id }}">
      <div class="input-box">
        <label class="uk-form-label Label uk-margin-bottom" for="form-stacked-text">Add Image (1)</label>

        <div class="uk-flex uk-flex-middle uk-flex-center uk-flex-column">
          <div class="upload-Rectangle-4 uk-inline srm-cursor-pointer" onclick="document.querySelector('#mms_media').click();">
            <input type="file" hidden id="mms_media" name="image" accept=".jpg,.png,.jpeg,.gif" @change="handleMediaChange">
            <div class="uk-position-center">
              <span class="fa fa-cloud-upload-alt upload-span"></span>
              <p class="upload-text">Click to Upload Image</p>
            </div>
          </div>

          <div v-show="attachment || campaign.image1" class="uk-alert uk-alert-primary uk-flex uk-margin-small-top" id="voice-att-alert"
               data-uk-alert style="word-break: break-word;">
            <div class="uk-flex uk-flex-center">
              <div class="uk-padding-small">
                <span data-uk-icon="icon: image; ratio: 1.8"></span>
              </div>
            </div>
            <div>
              <span class="uk-text-bold">Attached Image 1: <a v-if="campaign.image1" :href="campaign.image1" target="_blank">(VIEW)</a></span>
              <small>[[ attachment || campaign.image1 ]]</small>
              <a class="uk-position-absolute uk-position-top-right uk-margin uk-margin-right uk-text-danger"
                 @click.prevent="RemoveMMSFile('image1')" data-uk-icon="close">
              </a>
            </div>
          </div>

          <small class="uk-text-danger uk-text-small" v-if="errors.image1">[[ errors.image1[0] ]]</small>
          {#          <p class="uk-text-center uk-text-success">[[ attachment || campaign.image1 ]]</p>#}
        </div>

      </div>

      <div class="input-box">
        <label class="uk-form-label Label" for="form-stacked-text">Add Another Image</label>
        <div class="uk-form-controls input-box">
          <input class="srm-input" id="form-stacked-text" name="image2" type="file" accept=".jpg,.png,.jpeg,.gif">
          <small class="uk-text-danger uk-display-block uk-text-small" v-if="errors.image2">[[ errors.image2[0] ]]</small>

          <div v-show="campaign.image2" class="uk-alert uk-alert-primary uk-flex uk-margin-small-top" id="voice-att-alert"
               data-uk-alert style="word-break: break-word;">
            <div class="uk-flex uk-flex-center">
              <div class="uk-padding-small">
                <span data-uk-icon="icon: image; ratio: 1.8"></span>
              </div>
            </div>
            <div>
              <span class="uk-text-bold">Attached Image 2: <a :href="campaign.image2" target="_blank">(VIEW)</a></span>
              <small>[[ campaign.image2 ]]</small>
              <a class="uk-position-absolute uk-position-top-right uk-margin uk-margin-right uk-text-danger"
                 @click.prevent="RemoveMMSFile('image2')" data-uk-icon="close">
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="input-box">
        <label class="uk-form-label Label" for="form-stacked-text">Add Video (<i>Supports mp4, 3gp, 3gpp, webm</i>)</label>
        <div class="uk-form-controls input-box">
          <input class="srm-input" id="form-stacked-text" name="video" type="file" accept=".mp4, .3gp">
          <small class="uk-text-danger uk-display-block uk-text-small" v-if="errors.video">[[ errors.video[0] ]]</small>
          <div v-show="campaign.video" class="uk-alert uk-alert-primary uk-flex uk-margin-small-top" id="voice-att-alert"
               data-uk-alert style="word-break: break-word;">
            <div class="uk-flex uk-flex-center">
              <div class="uk-padding-small">
                <span data-uk-icon="icon: video-camera; ratio: 1.8"></span>
              </div>
            </div>
            <div>
              <span class="uk-text-bold">Attached Video: <a :href="campaign.video" target="_blank">(VIEW)</a></span>
              <small>[[ campaign.video ]]</small>
              <a class="uk-position-absolute uk-position-top-right uk-margin uk-margin-right uk-text-danger"
                 @click.prevent="RemoveMMSFile('video')" data-uk-icon="close">
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="input-box">
        <label class="uk-form-label Label" for="form-stacked-text">MMS text</label>
        <div class="uk-form-controls input-box">
          <textarea class="srm-input" maxlength="145" id="form-stacked-text" v-model="campaign.text" type="text" placeholder="Text" name="text"></textarea>
          <small class="uk-text-danger uk-text-small" v-if="errors.text">[[ errors.text[0] ]]</small>
        </div>
      </div>
      <div class="input-box">
        <label class="uk-form-label Label" for="form-stacked-text">Sample phone</label>
        <div class="uk-form-controls input-box">
          <input class="srm-input" id="form-stacked-text" name="sample_no" v-model="campaign.sample_no" type="text" placeholder="Enter to number to receive sample MMS">
          <small class="uk-text-danger uk-text-small" v-if="errors.sample_no">[[ errors.sample_no[0] ]]</small>
        </div>
      </div>

      {% if not is_follow_up %}
        <div class="input-box">
          <label class="uk-form-label Label" for="form-stacked-text">Set the delay</label>
          <div class="uk-form-controls input-box">
            <select class="srm-input" name="delay_type" v-model="delay_type">
              <option :value="key" v-for="(value, key) in delayTypes">[[ value ]]</option>
            </select>
          </div>
          <small class="uk-text-danger uk-text-small" v-if="errors.delay_type">[[ errors.delay_type[0] ]]</small>
        </div>

        <div class="input-box" v-if="delayTypeCanEnterDuration">
          <label class="uk-form-label Label" for="form-stacked-text">Delay Duration (in [[ delayTypes[delay_type] ]])</label>
          <div class="uk-form-controls input-box">
            <input class="srm-input" id="form-stacked-text" name="delay_value" type="number" placeholder="Enter delay duration" v-model="delay_value">
          </div>
          <small class="uk-text-danger uk-text-small" v-if="errors.delay_value">[[ errors.delay_value[0] ]]</small>
        </div>


        <div class="input-box" v-if="delayTypeIsDateScheduled">
          <label class="uk-form-label Label" for="form-stacked-text">Scheduled Date</label>
          <div class="uk-form-controls input-box">
            <input class="srm-input flat-datepicker" name="trigger_date" :data-initial="trigger_date" id="form-stacked-text" @change="setSendAt" placeholder="Enter scheduled date">
          </div>
          <small class="uk-text-danger uk-text-small" v-if="errors.trigger_date">[[ errors.trigger_date[0] ]]</small>
        </div>
      {% endif %}

      <div v-if="test_error" data-uk-alert class="uk-alert uk-alert-danger uk-width-1-1">[[ test_error ]]</div>
      <div v-if="errors.non_field_errors" data-uk-alert class="uk-alert uk-alert-danger uk-width-1-1">[[ errors.non_field_errors[0] ]]</div>

      <div class="formbox3 uk-width-1-1 uk-flex uk-flex-row uk-flex-center uk-padding-small">
        <button class="srm-button srm-button-primary-outline srm-button-large uk-margin-left" @click.prevent="handleTestMMS">Test</button>
        <button type="submit" class="srm-button srm-button-primary-outline srm-button-large uk-margin-medium-left">
          <span v-if="!isCreating">Save</span>
          <span v-else data-uk-spinner class="srm-text-primary"></span>
        </button>
      </div>
    </form>

  </div>
</div>
