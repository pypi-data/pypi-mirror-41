{% extends 'crm/base.html' %}
{% load static %}
{% block title %}
  Survey Responses
{% endblock title %}
{% block body_no_container %}
  <div id="survey-responses">
    <div class="uk-container uk-margin-top" id="surveys">
      <section data-uk-grid>
        <div class="uk-width-2-3@m">
          <div class="uk-flex uk-flex-between uk-flex-wrap">
            <div class="srm-page-heading">My Survey Responses</div>
            <div class="srm-page-heading">
              {% if object_list %}
                <a href="{% url 'srm:marketing:surveys:responses-download' 'all' %}" class="fixed-padding">
                  <span class="fas fa-download uk-margin-small-right"></span>
                  Download All
                </a>
              {% endif %}
            </div>
          </div>

          <div data-uk-grid>
            {% for answer in object_list %}
              <div class="uk-width-1-2@m">
                <div class="srm-contact-card">
                  <table class="srm-contact-card-table">
                    <tbody>
                    <tr>
                      <td class="fixed-padding2">
                        <div class="uk-width-1-1 uk-margin-remove uk-flex uk-flex-center">
                          <div class="srm-contact-card-value-medium uk-padding-remove-left"><span class="fas fa-comments uk-margin-small-right"></span>
                            {% if answer.question__survey__title %}
                              {{ answer.question__survey__title }}
                            {% endif %}
                          </div>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td class="uk-padding-remove-top uk-padding-remove-bottom">
                        <div class="uk-width-1-1 uk-flex uk-flex-center uk-padding-small">
                          <h4 class="uk-text-bold uk-margin-remove crm-large-text">
                            <a href="{% url 'srm:marketing:surveys:response' answer.contact__pk %}?survey={{ answer.question__survey__pk }}">
                              {{ answer.contact__phone }}
                            </a>
                          </h4>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div class="uk-width-1-1 uk-margin-remove">
                          <div class="uk-flex uk-flex-center">
                            <div>
                              <div class="round-border round-border-flex uk-flex uk-flex-center uk-flex-middle">
                                <h4 class="uk-text-bold crm-large-text uk-margin-remove">{{ answer.num_answers }}</h4>
                              </div>
                            </div>
                          </div>
                          <div class="uk-flex uk-flex-center margin-top-small">
                            <div class="srm-contact-card-value-medium uk-padding-remove-left"><img src="{% static 'crm/images/call-answer.png' %}" class="uk-margin-small-right">Survey responses</div>
                          </div>
                        </div>
                      </td>
                    </tr>

                    <tr>
                      <td class="uk-text-center">
                        <a href="{% url 'srm:marketing:surveys:responses-download' answer.question__survey__pk %}" target="_blank" class="srm-button srm-button-primary-outline crm_button-large">Download</a>
                      </td>
                    </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            {% empty %}
              <div class="uk-width-1-1">
                <div data-uk-alert class="uk-alert uk-alert-warning">
                  ðŸ˜Ÿ There are no responses currently!
                </div>
              </div>
            {% endfor %}
          </div>
          <ul class="uk-pagination uk-flex-center" uk-margin>
            {% if object_list.has_previous %}
              <li><a href="?page=1">&laquo; First</a></li>
              <li><a href="?page={{ object_list.previous_page_number }}"><span uk-pagination-previous></span></a></li>
            {% endif %}
            <li class="uk-disabled"><span>Page {{ object_list.number }} of {{ object_list.paginator.num_pages }}</span></li>
            {% if object_list.has_next %}
              <li><a href="?page={{ object_list.next_page_number }}"><span uk-pagination-next></span></a></li>
              <li><a href="?page={{ object_list.paginator.num_pages }}">Last &raquo;</a></li>
            {% endif %}
          </ul>

        </div>
        <div class="uk-width-1-3@m">
          <div class="uk-flex uk-flex-between uk-flex-wrap">
            <div class="srm-page-heading">URL analytics</div>
            <div class="srm-page-heading">
              <a href="{% url 'srm:marketing:surveys:url-clicks' %}" class="fixed-padding">
                <span class="fas fa-comments uk-margin-small-right"></span>
                URL clicks
              </a>
            </div>
          </div>
          <div data-uk-grid>
            {% for link in short_links %}
              <div class="uk-width-1-1">
                <div class="srm-card uk-padding-remove srm-contact-card uk-margin-small-top">
                  <table class="srm-contact-card-table">
                    <tbody>
                    <tr>
                      <td class="fixed-padding2">
                        <div class="uk-width-1-1 uk-margin-remove uk-flex uk-flex-center">
                          <div class="srm-contact-card-value-medium uk-padding-remove-left"><span class="fas fa-comments uk-margin-small-right"></span>{{ link.question__survey__title }}</div>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td class="fixed-padding4">
                        <div class="uk-width-1-1">
                          <div class="srm-contact-card-value-small">{{ link.long_url }}</div>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <div class="uk-width-1-1 uk-margin-remove" data-uk-grid>
                          <div class="uk-width-1-2 uk-padding-remove-left uk-padding-remove-right">
                            <div class="uk-flex uk-flex-center">
                              <div>
                                <div class="round-border round-border-flex uk-flex uk-flex-center uk-flex-middle">
                                  <h4 class="uk-text-bold crm-large-text uk-margin-remove">{{ link.total }}</h4>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="uk-width-1-2 uk-padding-remove-left uk-padding-remove-right">
                            <div class="uk-flex uk-flex-center">
                              <div>
                                <div class="round-border round-border-flex uk-flex uk-flex-center uk-flex-middle">
                                  <h4 class="uk-text-bold crm-large-text uk-margin-remove">{{ link.clicks }}</h4>
                                </div>
                              </div>
                            </div>

                          </div>
                          <div class="uk-width-1-2 uk-padding-remove-left uk-padding-remove-right margin-top-medium">
                            <div class="uk-flex uk-flex-center">
                              <div class="srm-contact-card-value-medium uk-padding-remove-left"><img src="{% static 'crm/images/contacts-icon@2x.png' %}" class="uk-margin-small-right">People</div>
                            </div>
                          </div>


                          <div class="uk-width-1-2 uk-padding-remove-left uk-padding-remove-right margin-top-medium">
                            <div class="uk-flex uk-flex-center">
                              <div class="srm-contact-card-value-medium uk-padding-remove-left uk-padding-remove-right"><img src="{% static 'crm/images/cursor.png' %}" class="uk-margin-small-right">Clicks</div>
                            </div>
                          </div>
                        </div>

                      </td>
                    </tr>

                    <tr>
                      <td>
                        <button class="srm-button srm-button-primary-outline crm_button-large">Download</button>
                      </td>
                    </tr>
                    </tbody>
                  </table>
                </div>
              </div>

            {% empty %}
              <div class="uk-width-1-1">
                <div data-uk-alert class="uk-alert uk-alert-warning">
                  ðŸ˜Ÿ There are no URL analytics currently!
                </div>
              </div>

            {% endfor %}
          </div>
        </div>
      </section>
    </div>
  </div>
{% endblock body_no_container %}
{% block extra_js %}
  <script src="{% static 'crm/js/marketing/surveys/responses.js' %}"></script>
{% endblock extra_js %}
