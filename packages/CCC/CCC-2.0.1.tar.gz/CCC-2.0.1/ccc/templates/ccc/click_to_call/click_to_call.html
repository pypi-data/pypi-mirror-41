{% extends 'ccc/campaigns/base.html' %}
{% load staticfiles %}
{% block title %}Click to call{% endblock title %}

{% block css %}
<link rel="stylesheet" href="{% static 'home/assets/css/main.css' %}" />
<link rel="stylesheet" href="{% static 'home/assets/css/bootstrap.min.css' %}" />
<style>
    .gridStyle {
        border: 1px solid rgb(212,212,212);
        width: 400px;
        height: 300px
    }
</style>

{% endblock css %}

{% block scripts %}
<script type="text/javascript" src="{% static 'js/twilio.min.js' %}"></script>

<script type="text/javascript" src="{% static 'angular_apps/click_to_call/auto_dialer.js' %}"></script>
<script type="text/javascript" src="{% static 'js/browser-calls.js' %}"></script>
{% endblock scripts %}

{% block content %}

<!-- BEGIN PAGE HEADER-->
<div class="row">
    <div class="col-md-12">
        <!-- BEGIN PAGE TITLE & BREADCRUMB-->
        <h3 class="page-title"> Browser Call </h3>

        <!-- END PAGE TITLE & BREADCRUMB-->
    </div>
</div>
<!-- END PAGE HEADER-->

<div class="row" ng-app="DialerApp">
    <div class="col-md-12" ng-controller="DialerController">
        <!-- BEGIN INLINE NOTIFICATIONS PORTLET-->
        <div class="portlet">
            <div class="portlet-title">
                <div class="caption">
                    <i class="fa fa-cogs"></i>Click To Call
                </div>
            </div>
            <div class="form-group">
                <h3>Call</h3>
            </div>
            <div class="row portlet-body">
                <div class="col-md-12 form-group ">
                    <label>Call Status</label>
                    <span id="call-status"></span>
                </div>
                <div class="margin-bottom-40 col-md-12 form-group ">
                    <!-- Pricing -->
                    <form id="contactForm" role="form">
                        <div class="col-md-12">
                            <div class="col-md-6">
                                <label> Select Twilio Number</label>
                                <select name="twilioNumber" id="twilioNumber">
                                    {% for obj in phones %}
                                    <option val="{{ obj.twilio_number}}">{{ obj.twilio_number }}</option>
                                    {% endfor %}
                                </select>
                            </div>

                            <div class="col-md-6">
                                <label> Phone Number</label>
                                <input type="text" id="phoneNumber" ng-model="phone_number"
                                placeholder="(651) 555-7889" class="form-control" size="20">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="col-md-12" align="center">
                    <button class="btn btn-lg btn-danger hangup-button" onclick="hangUp()">
                        Hang up
                    </button>

                    <button onclick="callCustomer()" type="button" class="btn btn-primary btn-lg call-customer-button">
                        <span class="glyphicon glyphicon-earphone" aria-hidden="true"></span> Call customer
                    </button>
                </div>
                <hr />
                <div class="col-md-12" >
                    {% if master_list_id %}
                    <table class="table" show-filter="false" ng-init="fetch_dailer_with_list_id('{{ master_list_id }}')">
                        <th> Phone Number </th>
                        <th> Type </th>
                        <th> Status </th>
                        <th> Carrier </th>
                        <th> Dial Status </th>
                        <th> Action </th>
                        <tr ng-repeat="obj in results.items">
                            <td title="{$ obj.phone_number $}" > {$ obj.phone_friendly_number $}</td>
                            <td title="{$ obj.phone_type $}" > {$ obj.phone_type $}</td>
                            <td title="{$ obj.phone_status $}" > {$ obj.phone_status $}</td>
                            <td title="{$ obj.phone_carrier $}" > {$ obj.phone_carrier $}</td>
                            <td title="{$ obj.is_processed $}" > {$ obj.is_processed $}</td>
                            <td title="click to select" ng-click="changePhoneNumber(obj.number)">
                            <button type="button" class="btn-link">
                                Select
                            </button></td>
                        </tr>
                    </table>
                    <uib-pagination
                    ng-model="results.currentPage"
                    total-items="results.count"
                    max-size="10"
                    ng-change="results.nextPage(results.currentPage, true)"
                    boundary-links="true"></uib-pagination>
                    {% endif %}
                </div>

            </div>
        </div>
        <!-- END INLINE NOTIFICATIONS PORTLET-->
    </div>

</div>

{% endblock content %}

