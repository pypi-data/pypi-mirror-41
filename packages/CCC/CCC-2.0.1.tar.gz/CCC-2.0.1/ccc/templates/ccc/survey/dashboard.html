{% extends 'ccc/campaigns/base.html' %}
{% load tz static survey_tags %}
{% block title%}Surveys {% endblock %}
{% block content %}
<div class="row">
	<div class="col-md-12">
		<ul class="page-breadcrumb breadcrumb">
			<li>
				<i class="fa fa-mobile"></i>
				<a href="{% url 'users.dashboard' %}"> Dashboard </a>
				<i class="fa fa-angle-right"></i>
			</li>
			<li>
				<a href="{% url 'survey_dashboard' %}"> My Survey Responses </a>
				<i class="fa fa-angle-right"></i>
			</li>
			<li>
				<a href="{% url 'survey_clicks_dashboard' %}"> URL Clicks </a>
			</li>
		</ul>
	</div>
</div>

<div class="row" style="margin-bottom: 10px;">
	<div class="col-md-12">

		<div class="pull-right">
			<form id="select_survey">
				<span>Choose Survey:</span>
				<select name="survey" id="survey_doanload_id">
					<option value="">All</option>
					{% for s in surveys %}
					<option value="{{ s.pk }}" {% if survey == s.pk %}selected{% endif %}>{{ s.title }}</option>
					{% endfor %}
				</select>
				<button type="button" id="download_survey_response" class="btn btn-primary download_survey_response">Download</button>
			</form>
		</div>
	</div>
</div>

<div class="row">
	<div class="col-md-12">
		<div class="portlet box blue">
			<div class="portlet-title">
				<div class="caption">
					<i class="fa fa-moble-phone"></i> My Survey Responses
				</div>
			</div>

			<div class="portlet-body">
				<table class="table table-striped table-bordered table-hover table-full-width" id="sample_2">
					<thead>
						<tr>
							<th><i class="fa fa-bullhorn"></i> Survey </th>
							<th><i class="fa fa-mobile"></i> Phone Number </th>
							<th><i class="fa fa-mobile"></i> Responses </th>


						</tr>
					</thead>
					{% for answer in object_list %}
					<tr>
						<td> {% if answer.question__survey__title %}
						{{ answer.question__survey__title }}
						{% endif %} </td>
						<td><a href="{% url 'survey_response' answer.contact__pk %}?survey={{ answer.question__survey__pk }}">{{ answer.contact__phone }}</a></td>
						<td><span class="badge">{{ answer.num_answers }}</span></td>

					</tr>
					{% endfor %}
				</table>
			</div>
		</div>
	</div>
</div>

<div class="row">
	<div class="col-md-12">
		<div class="portlet box blue">
			<div class="portlet-title">
				<div class="caption">
					<i class="fa fa-moble-phone"></i> URL Analytics
				</div>
			</div>

			<div class="portlet-body">
				<table class="table table-striped table-bordered table-hover table-full-width" id="sample_2">
					<thead>
						<tr>
							<th><i class="fa fa-bullhorn"></i> Survey </th>
							<th><i class="fa fa-bullhorn"></i> URL </th>
							<th><i class="fa fa-mobile"></i> Number of people received </th>
							<th><i class="fa fa-mobile"></i> Number of clicks </th>

						</tr>
					</thead>
					{% for link in short_links %}
					<tr>
						<td> {{ link.question__survey__title }} </td>
						<td> {{ link.long_url }} </td>
						<td><span class="badge">{{ link.total }}</span></td>
						<td><a href="{% url 'survey_clicks_dashboard' %}?url={{ link.long_url|urlencode }}"><span class="badge">{{ link.clicks }}</span></a></td>
					</tr>
					{% endfor %}
				</table>
			</div>
		</div>
	</div>
</div>

{% endblock %}

{% block scripts %}
<script type="text/javascript" src="{% static "js/survey.js" %}"></script>
{% endblock scripts %}
