{% extends 'ccc/campaigns/base.html' %}
{% load tz static i18n staticfiles %}
{% block title %}Received SMS {% endblock title %}
{% block css %}
<link rel="stylesheet" type="text/css" href="{% static 'assets/plugins/select2/select2.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'assets/plugins/select2/select2-metronic.css' %}"/>
<link rel="stylesheet" href="{% static 'assets/plugins/data-tables/DT_bootstrap.css' %}"/>
<!-- END PAGE LEVEL STYLES -->
{% endblock css %}

{% block content %}
<!-- BEGIN PAGE HEADER-->
<div class="row">
    <div class="col-md-12">
        <!-- BEGIN PAGE TITLE & BREADCRUMB-->

        <h3 class="page-title"> Received SMS<small></small></h3>
        <ul class="page-breadcrumb breadcrumb">

            <li>
                <i class="fa fa-mobile-phone"></i>
                <a href="#"> Received SMS </a>
                <i class="fa fa-angle-right"></i>
            </li>
            <li>
                <a href="/osms-report/"> Sent SMS </a>
                <i class="fa fa-angle-right"></i>
            </li>
            <li>
                <a href="/sms-campaigns/"> My SMS Campaigns </a>
                <i class="fa fa-angle-right"></i>
            </li>

        </ul>
        <!-- END PAGE TITLE & BREADCRUMB-->
    </div>
</div>
<!-- END PAGE HEADER-->
<!-- BEGIN PAGE CONTENT-->
<div class="row" ng-app="SmsListApp">
    <div class="col-md-12" ng-controller="SmsListController">

        <!-- BEGIN EXAMPLE TABLE PORTLET-->
        <div class="portlet box blue" ng-init="initial_calls()">
            <div class="portlet-title">
                <div class="caption">
                    <i class="fa fa-moble-phone"></i>Received SMS
                </div>
                <div class="actions">
                    <div class="btn-group">
                        <div id="sample_2_column_toggler" class="dropdown-menu hold-on-click dropdown-checkboxes pull-right">
                            <label>
                                <input type="checkbox" checked data-column="0">
                                Date</label>
                            <label>
                                <input type="checkbox" checked data-column="1">
                                Campaign No</label>
                            <label>
                                <input type="checkbox" checked data-column="2">
                                Campaign</label>
                            <label>
                                <input type="checkbox" checked data-column="3">
                                Text</label>
                            <label>
                                <input type="checkbox" checked data-column="4">
                                Sender</label>
                            <label>
                                <input type="checkbox" checked data-column="5">
                                Country</label>
                            <label>
                                <input type="checkbox" checked data-column="6">
                                City</label>
                            <label>
                                <input type="checkbox" checked data-column="7">
                                Zip</label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="portlet-body">
                <table class="table table-striped table-bordered table-hover table-full-width" id="sample_2">
                    <thead>
                        <tr>

                            <th><i class="fa fa-calendar"></i> Date </th>
                            <th><i class="fa fa-phone"></i> Campaign No </th>
                            <th><i class="fa fa-bullhorn"></i> Campaign </th>
                            <th><i class="fa fa-file-text"></i> Text </th>
                            <th><i class="fa fa-file-text"></i> Reply </th>

                            <th class="hidden-xs"><i class="fa fa-phone"></i> Sender </th>
                            <th class="hidden-xs"><i class="fa fa-globe"></i> Country </th>

                            <th class="hidden-xs"> City </th>
                            <th class="hidden-xs"> Zip </th>

                        </tr>
                    </thead>
                    <tbody ng-repeat="vc in results.items">
                        <tr>
                            <td> {$ vc.date_created $} </td>
                            <td> {$ vc.to $} </td>

                            <td> {$ vc.campaign $} </td>
                            <td class="toggler" ng-click="toggle_sms(vc.id)" data-prod-cat="{$vc.id$}" title="{$vc.text $}">  {$ vc.text | limitTo: 20 $}{$vc.text.length > 20 ? '...' : ''$}  </td>
                            <td>
                            <button type="button" ng-click="reply_toggle(vc.id)" class="btn btn-link reply_toggler" data-prod-cat="{$vc.id$}">
                                Reply
                            </button></td>
                            <td> {$ vc.from_no $} </td>
                            <td> {$ vc.from_country $} </td>
                            <td> {$ vc.from__city $} </td>
                            <td> {$ vc.from_zip $} </td>
                        </tr>

                        <tr class="cat{$vc.id$}" style="display:none">
                            <td style="display: none;"></td>
                            <td style="display: none;"></td>
                            <td style="display: none;"></td>
                            <td style="display: none;"></td>
                            <td style="display: none;"></td>
                            <td style="display: none;"></td>
                            <td style="display: none;"></td>
                            <td style="display: none;"></td>
                            <td colspan="9"><b>Incoming Message: </b>"{$vc.text $}"</td>
                        </tr>

                        <tr class="reply{$vc.id$}" style="display:none">
                            <td style="display: none;"></td>
                            <td style="display: none;"></td>
                            <td style="display: none;"></td>
                            <td style="display: none;"></td>
                            <td style="display: none;"></td>
                            <td style="display: none;"></td>
                            <td style="display: none;"></td>
                            <td style="display: none;"></td>
                            <td colspan="9">                            
                            <textarea rows"5" cols="60" name="send_sms_{$ vc.id $}" id="send_sms_{$ vc.id $}"></textarea>
                            <button type="button" class="btn btn-sm btn-primary" ng-click="trigger_sms_reply(vc.id, '{{csrf_token}}')">
                                Send
                            </button>
                            <b><p name="sms_error{$ vc.id $}" id="sms_error{$ vc.id $}"></p></b>
                            
                            </td>
                        </tr>

                    </tbody>
                    <tr>
                            <th colspan="11"><uib-pagination
                            ng-model="results.currentPage"
                            total-items="results.count"
                            max-size="10"
                            ng-change="results.nextPage(results.currentPage, true)"
                            boundary-links="true"></uib-pagination></th>
                        </tr>
                </table>
            </div>
        </div>
        <!-- END EXAMPLE TABLE PORTLET-->
    </div>
</div>
{% endblock content %}

{% block scripts %}
<!-- BEGIN PAGE LEVEL PLUGINS -->
<script type="text/javascript" src="{% static 'assets/plugins/select2/select2.min.js' %}"></script>
<script type="text/javascript" src="{% static 'angular_apps/sms/sms_list.js' %}"></script>
<!-- END PAGE LEVEL PLUGINS -->
<!-- BEGIN PAGE LEVEL SCRIPTS -->

<script src="{% static 'assets/scripts/custom/table-advanced.js' %}"></script>


{% endblock scripts %}
