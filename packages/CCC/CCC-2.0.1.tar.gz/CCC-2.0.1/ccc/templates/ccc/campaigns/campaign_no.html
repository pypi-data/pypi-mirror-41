{% extends 'ccc/campaigns/base.html' %}
{% load tz static i18n staticfiles %}
{% block title %} My Numbers{% endblock title %}
{% block css %}
 <link rel="stylesheet" type="text/css" href="{% static 'assets/plugins/select2/select2.css' %}"/>
<link rel="stylesheet" type="text/css" href="{% static 'assets/plugins/select2/select2-metronic.css' %}"/>
<link rel="stylesheet" href="{% static 'assets/plugins/data-tables/DT_bootstrap.css' %}"/>
<!-- END PAGE LEVEL STYLES -->
 {% endblock css %}


{% block content %}
			<!-- BEGIN PAGE HEADER-->
			<div class="row">
				<div class="col-md-12">
					<!-- BEGIN PAGE TITLE & BREADCRUMB-->

					<ul class="page-breadcrumb breadcrumb">
            <li class="btn-group">
              <span class="primary yellow">
                <button class="btn default" data-toggle="modal" data-target="#select-numbers-modal">
                  {% if balance.phones > 0 %}
                    <i class="fa fa-plus"></i> Setup more Numbers ({{ balance.phones }})
                  {% else %}
                    <i class="fa fa-plus"></i> Purchase more Numbers
                  {% endif %}
                </button>
              </span>
            </li>
						<li>
							<i class="fa fa-phone"></i>
							<a href="#">
								My Purchased Numbers
							</a>
							<i class="fa fa-angle-right"></i>
						</li>

					</ul>
					<!-- END PAGE TITLE & BREADCRUMB-->
				</div>
			</div>
			<!-- END PAGE HEADER-->
			<!-- BEGIN PAGE CONTENT-->
			<div class="row">
				<div class="col-md-12">

					<!-- BEGIN EXAMPLE TABLE PORTLET-->
					<div class="portlet box blue">
						<div class="portlet-title">
							<div class="caption">
								<i class="fa fa-phone"></i>My Purchased Numbers
							</div>
							<div class="actions">
								<div class="btn-group">
									<a class="btn default" href="#" data-toggle="dropdown">
										 Columns <i class="fa fa-angle-down"></i>
									</a>
									<div id="sample_2_column_toggler" class="dropdown-menu hold-on-click dropdown-checkboxes pull-right">
                    <label><input type="checkbox" checked data-column="0">Purchase Date</label>
                    <label><input type="checkbox" checked data-column="1">Phone Number</label>
                    <label><input type="checkbox" checked data-column="2">In Use</label>
                    <label><input type="checkbox" checked data-column="3">Campaign/Survey</label>
                    <label><input type="checkbox" checked data-column="4">Voice</label>
                    <label><input type="checkbox" checked data-column="5">SMS</label>
                    <label><input type="checkbox" checked data-column="6">MMS</label>
									</div>
								</div>
							</div>
						</div>
						<div class="portlet-body">
							<table class="table table-striped table-bordered table-hover table-full-width" id="sample_2">
							<thead>
							<tr>
								<th>
									 <i class="fa fa-calendar"></i> Purchase Date
								</th>
								<th>
									<i class="fa fa-phone"></i> Phone Number
								</th>
                                <th>
									<i class="fa fa-info-circle"></i> In Use
								</th>
                                <th>
									<i class="fa fa-bullhorn"></i> Campaign/Survey
								</th>

								<th class="hidden-xs" style="background-color:purple">

									 <i class="fa fa-volume-up"></i> Voice
								</th>

								<th class="hidden-xs" style="background-color:steelblue">
									  <i class="fa fa-mobile-phone" ></i> SMS
								</th>
                                <th class="hidden-xs yellow" style="background-color:orange"> <span >
									 <i class="fa fa-instagram"></i> MMS</span>
								</th>
                <th></th>


							</tr>
							</thead>
              <tbody>
                {% for number in twilio_numbers %}
                  <tr>
                    <td>{{ number.date_created }}</td>
                    <td>{{ number.twilio_number }}</td>
                    <td>
                      {% if number.in_use %}
                        <i class="fa fa-check"></i>
                      {% else %}
                        <i class="fa fa-times"></i>
                      {% endif %}
                    </td>
                    <td>
                      {% if number.get_campaign %}
                        {{ number.get_campaign.name }}
                      {% elif number.surveys.all %}
                        {{ number.surveys.all.0.title }}
                      {% else %}
                        Not in Use
                      {% endif %}
                    </td>
                    <td>
                      {% if number.voice_enabled %}
                        <i class="fa fa-check"></i>
                      {% else %}
                        <i class="fa fa-times"></i>
                      {% endif %}
                    </td>
                    <td>
                      {% if number.sms_enabled %}
                        <i class="fa fa-check"></i>
                      {% else %}
                        <i class="fa fa-times"></i>
                      {% endif %}
                    </td>
                    <td>
                      {% if number.mms_enabled %}
                        <i class="fa fa-check"></i>
                      {% else %}
                        <i class="fa fa-times"></i>
                      {% endif %}
                    </td>
                  <td>
                    {% if number.in_use %}
                      in use
                    {% else %}
                      <a href="{% url 'release_number' number.pk %}" class="number-release"><i class="fa fa-trash-o"></i> release</a>
                    {% endif %}
                  </td>
                  </tr>
                {% endfor %}
              </tbody>
							</table>
						</div>
					</div>
					<!-- END EXAMPLE TABLE PORTLET-->
				</div>
			</div>

    {% include 'ccc/campaigns/buy_number.modal.inc.html' %}

{% endblock content %}

{% block scripts %}

<!-- BEGIN PAGE LEVEL PLUGINS -->
<script type="text/javascript" src="{% static 'assets/plugins/select2/select2.min.js' %}"></script>
<script type="text/javascript" src="{% static 'assets/plugins/data-tables/jquery.dataTables.min.js' %}"></script>
<script type="text/javascript" src="{% static 'assets/plugins/data-tables/DT_bootstrap.js' %}"></script>
<!-- END PAGE LEVEL PLUGINS -->
<!-- BEGIN PAGE LEVEL SCRIPTS -->

<script src="{% static 'assets/scripts/custom/table-advanced.js' %}"></script>
<script>
jQuery(document).ready(function() {
  TableAdvanced.init();

  $(document).on('click', '.number-release', function(){
    if(!confirm("Are you sure to release this number? This action is not reversible, you might not be able to reserve the same number again."))
        return false;

    $.ajax({
      url: $(this).attr("href"),
      type: "POST",
      data: {'csrfmiddlewaretoken': $('input[name=csrfmiddlewaretoken]').val()},
      success: function (response, textStatus, jqXHR) {
        window.location.reload();
      },
      error: function (jqXHR, textStatus, errorThrown) {
        if ((jqXHR.responseJSON) && (jqXHR.responseJSON.error)){
          alert(jqXHR.responseJSON.error);
        }
      }
    });

    return false;
  });
});
</script>
    <style>
    td{
        text-align: center;
    }
    </style>
{% endblock scripts %}
