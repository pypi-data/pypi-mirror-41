"""
benchmarking
============
Module containing benchmarking tests for the different algorithms and example data.
"""
import sys
import time
import os
try:
    import cPickle as pickle
except ImportError:
    import pickle

import numpy as np

from MTfit.inversion import Inversion, ForwardTask
from MTfit.probability.probability import polarity_ln_pdf, amplitude_ratio_ln_pdf
from MTfit.sampling import convert_keys_to_unicode
from MTfit.algorithms.markov_chain_monte_carlo import MarkovChainMonteCarloAlgorithmCreator

DEFAULT_SAMPLE_RANGE = [10000, 50000, 80000, 100000, 200000, 500000, 700000,
                        1000000, 3000000, 5000000, 7000000, 100000000]
DEFAULT_ITERATION_RANGE = [1, 10, 100, 1000, 5000, 10000, 30000, 50000, 100000]

if sys.platform == "win32":
    # On Windows, the best timer is time.clock()
    default_timer = time.clock
else:
    # On most other platforms the best timer is time.time()
    default_timer = time.time


# Run benchmark for single iteration step for example event_file
def run_benchmarks():
    # default event data
    # write data file
    data_file = _write_default_event()
    results = algorithm_benchmarks(data_file)
    # delete data file
    _delete_default_event(data_file)
    print results


def algorithm_benchmarks(event_file, scatter_file=None, algorithm=None, plot=False, save_matlab=True, matlab_version='7.3',
                         sample_range=DEFAULT_SAMPLE_RANGE, iteration_size_range=DEFAULT_ITERATION_RANGE, dc=True,
                         mt=True, repeat_times=1):
    """Run algorithm benchmarks for an example event file, if algorithm is set to None, all algorithms are used"""
    results = {}
    if not algorithm or algorithm.lower().replace('-', '').replace(' ', '') in ['randomsampling', 'iterate', 'time', 'random']:
        algorithm = 'iterate'
        results[algorithm] = _run_benchmarks(event_file, scatter_file, algorithm, sample_range, iteration_size_range, dc, mt, repeat_times)
    if not algorithm or algorithm.lower().replace('-', '').replace(' ', '') in ['mcmc', 'markovchain', 'markovchainmontecarlo']:
        algorithm = 'mcmc'
        results[algorithm] = _run_benchmarks(event_file, scatter_file, algorithm, sample_range, iteration_size_range, dc, mt, repeat_times)
    if not algorithm or algorithm.lower().replace('-', '').replace(' ', '') in ['transd', 'transdmcmc', 'transdmarkovchain', 'transdmarkovchainmontecarlo']:
        algorithm = 'transdmcmc'
        results[algorithm] = _run_benchmarks(event_file, scatter_file, algorithm, sample_range, iteration_size_range, dc, mt, repeat_times)
    if plot:
        plot_benchmarks(results)
    if save_matlab:
        if matlab_version == '7.3':
            try:
                from hdf5storage import savemat
            except Exception:
                from scipy.io import savemat
                matlab_version = '7'
        else:
            from scipy.io import savemat
        if matlab_version == '7.3':
            results = convert_keys_to_unicode(results)
        savemat('benchmark_results.mat', results, matlab_version)
    return results


def _run_benchmarks(event_file, scatter_file, algorithm, sample_range, iteration_size_range, dc, mt, repeat_times):
    results = {'samples': {}}
    # Benchmark sample steps
    for nsamples in sample_range:
        print '\n\n==================\nRunning benchmark for '+str(nsamples)+' samples and algorithm '+str(algorithm)+'\n\n==================\n\n'
        if mt:
            test_inversion = Inversion(data_file=event_file, angle_scatter_file_path=scatter_file,
                                       algorithm=algorithm, parallel=False, dc=False, max_samples=nsamples,
                                       chain_length=nsamples, output_format=False)
            test_inversion.pool = False
            test_inversion.number_samples = min(test_inversion.number_samples, nsamples)
            times, nsamples = _full_inversion_time(test_inversion, repeat_times)
            if nsamples not in results['samples']:
                results['samples'][nsamples] = {}
            results['samples'][nsamples]['MT'] = times
        if dc:
            test_inversion = Inversion(data_file=event_file, angle_scatter_file_path=scatter_file,
                                       algorithm=algorithm, parallel=False, dc=True, max_samples=nsamples,
                                       chain_length=nsamples, output_format=False)
            test_inversion.pool = False
            test_inversion.number_samples = min(test_inversion.number_samples, nsamples)
            times, nsamples = _full_inversion_time(test_inversion, repeat_times)
            if nsamples not in results['samples']:
                results['samples'][nsamples] = {}
            results['samples'][nsamples]['DC'] = times
        print '\n\n==================\nBenchmark for '+str(nsamples)+' samples and algorithm '+str(algorithm)+' complete\n\n==================\n\n'
    results['iteration_step'] = {}
    # Benchmark iteration steps
    calculated_iteration_size = test_inversion.number_samples
    for i in iteration_size_range:
        if i <= calculated_iteration_size:
            print '\n\n==================\nRunning benchmark for '+str(i)+' iteration samples and algorithm '+str(algorithm)+'\n\n==================\n\n'
            results['iteration_step'][i] = {}
            if mt:
                test_inversion = Inversion(data_file=event_file, angle_scatter_file_path=scatter_file,
                                           algorithm=algorithm, parallel=False, dc=False, max_samples=nsamples,
                                           chain_length=nsamples, output_format=False)
                test_inversion.number_samples = i
                test_inversion._set_algorithm(**test_inversion.kwargs)
                results['iteration_step'][i]['MT'] = _iteration_step_time(test_inversion, repeat_times)
            if dc:
                test_inversion = Inversion(data_file=event_file, angle_scatter_file_path=scatter_file,
                                           algorithm=algorithm, parallel=False, dc=True, max_samples=nsamples,
                                           chain_length=nsamples, output_format=False)
                test_inversion.pool = False
                test_inversion.number_samples = i
                test_inversion._set_algorithm(**test_inversion.kwargs)
                results['iteration_step'][i]['DC'] = _iteration_step_time(test_inversion, repeat_times)
    return results


def _full_inversion_time(test_inversion, repeat_times):
    i = 0
    results = []
    while i < repeat_times:
        starttime = default_timer()
        test_inversion.forward()
        nsamples = test_inversion.algorithm.pdf_sample.n
        endtime = default_timer()
        results.append(endtime-starttime)
        i += 1
    if len(results) == 1:
        results = results[0]
    return results, nsamples


def _iteration_step_time(test_inversion, repeat_times):
    i = 0
    results = []
    while i < repeat_times:
        if test_inversion._algorithm_name.lower() == 'iterate':
            (a_polarity, error_polarity, a1_amplitude_ratio, a2_amplitude_ratio, amplitude_ratio, error1_amplitude_ratio, error2_amplitude_ratio,
             a_polarity_prob, polarity_prob, error_polarity_prob) = test_inversion._station_angles(test_inversion.data[0], 0)
            starttime = default_timer()
            MTs, end = test_inversion._parse_job_result(False)
            result = ForwardTask(MTs, a_polarity, error_polarity, a1_amplitude_ratio, a2_amplitude_ratio, amplitude_ratio, error1_amplitude_ratio,
                                 error2_amplitude_ratio, a_polarity_prob, polarity_prob, error_polarity_prob, return_zero=True, reuse=False)()
            MTs, end = test_inversion._parse_job_result(result)
            endtime = default_timer()
        else:
            (a_polarity, error_polarity, a1_amplitude_ratio, a2_amplitude_ratio, amplitude_ratio, error1_amplitude_ratio, error2_amplitude_ratio,
             a_polarity_prob, polarity_prob, error_polarity_prob) = test_inversion._station_angles(test_inversion.data[0], 0)
            algorithm = MarkovChainMonteCarloAlgorithmCreator(**test_inversion.algorithm_kwargs)
            mts, end = algorithm.initialise()
            starttime = default_timer()
            forward = ForwardTask(mts, a_polarity, error_polarity, a1_amplitude_ratio, a2_amplitude_ratio, amplitude_ratio, error1_amplitude_ratio, error2_amplitude_ratio, a_polarity_prob, polarity_prob, error_polarity_prob, return_zero=True, reuse=True)
            while algorithm._initialising:
                forward.mt = mts
                result = forward()
                mts, end = algorithm.iterate(result)
            starttime = default_timer()
            forward.mt = mts
            result = forward()
            mts, end = algorithm.iterate(result)
            endtime = default_timer()
        results.append(endtime-starttime)
    if len(results) == 1:
        results = results[0]
    return results


def plot_benchmarks(results):
    from matplotlib import pyplot as plt
    samples = []
    dc = []
    mt = []
    for x in results['samples'].keys():
        samples.append(x)
        dc.append(results['samples'][x]['DC'])
        mt.append(results['samples'][x]['MT'])
    plt.subplot(2, 1, 1)
    plt.hold(True)
    plt.plot(samples, dc, 'rx')
    plt.plot(samples, mt, 'bx')
    plt.hold(False)
    iteration_step = []
    dc = []
    mt = []
    for x in results['iteration_step'].keys():
        iteration_step.append(x)
        dc.append(results['iteration_step'][x]['DC'])
        mt.append(results['iteration_step'][x]['MT'])
    plt.subplot(2, 1, 2)
    plt.hold(True)
    plt.plot(iteration_step, dc, 'rx')
    plt.plot(iteration_step, mt, 'bx')
    plt.hold(False)
    plt.show()


def _write_default_event():
    data_file = os.path.abspath('./benchmarkingevent.inv')
    with open(data_file, 'wb') as f:
        pickle.dump(_default_event(), f)
    return data_file


def _delete_default_event(data_file):
    os.remove(data_file)


def _default_event():
    return {'P/SHRMSAmplitudeRatio': {'Error': np.matrix([[199.44352088,   21.62372527],
                                                          [498.66364286,    8.70323068],
                                                          [170.54788088,    5.594451],
                                                          [581.55286273,    9.46889106],
                                                          [299.81757325,   46.19534894],
                                                          [561.43914757,   12.51752148],
                                                          [535.28222675,   24.50181316],
                                                          [537.40417781,   15.16310774],
                                                          [8.7168497,   19.63458484],
                                                          [458.8678666,   51.99317775],
                                                          [441.37237125,   16.29669511],
                                                          [23.64324641,   15.1128682],
                                                          [290.87994937,   16.24893782],
                                                          [408.32861417,   14.33273385],
                                                          [229.10234866,   32.43160921],
                                                          [430.97483831,   65.87107192],
                                                          [176.3811002,   20.8928473],
                                                          [545.59795729,    9.62307117],
                                                          [521.90443116,   10.93144098],
                                                          [168.61291224,   17.03147822],
                                                          [656.48434059,    3.8047885],
                                                          [273.64737246,   26.74897284],
                                                          [58.39741578,    4.31885618],
                                                          [247.70818028,   17.01495775],
                                                          [153.82083499,    9.95501639],
                                                          [169.52032733,   29.9659421],
                                                          [70.87123312,    5.49772458],
                                                          [65.4973787,   10.53896346],
                                                          [387.03283146,   49.11239697],
                                                          [486.60131689,   15.53669462],
                                                          [200.05876369,   31.84654865],
                                                          [436.64287387,    5.42992212],
                                                          [171.55330901,    9.59333439],
                                                          [190.96870304,   12.80812676],
                                                          [198.48425104,    7.33105253],
                                                          [402.01014327,   16.58254691],
                                                          [353.40687635,   68.39544041],
                                                          [538.08763708,   10.79765277],
                                                          [672.27365927,    1.52617281],
                                                          [157.18188682,    6.83095756],
                                                          [436.84292331,    6.98502622],
                                                          [446.53274846,   12.68138407],
                                                          [472.25255867,   12.76140636],
                                                          [465.35862791,   47.47025807],
                                                          [502.06193039,    8.68587556],
                                                          [275.59479624,   19.00739329],
                                                          [158.49020081,    6.83572288],
                                                          [512.29010846,   19.83893775],
                                                          [64.43022752,   19.32498077]]),
                                      'Measured': np.matrix([[6.15648635e-08,   1.62124698e-07],
                                                             [1.53929061e-07,   6.52698738e-08],
                                                             [5.26452383e-08,   6.39935037e-08],
                                                             [1.79515359e-07,   2.82238355e-09],
                                                             [9.25485505e-08,   4.98021494e-08],
                                                             [1.73306602e-07,   1.06897427e-08],
                                                             [1.65232611e-07,   4.83737361e-08],
                                                             [1.65887399e-07,   1.33617621e-08],
                                                             [2.68984723e-09,   1.11679455e-08],
                                                             [1.41644867e-07,   9.51630122e-09],
                                                             [1.36243987e-07,   1.08537209e-07],
                                                             [7.29829366e-09,   1.42938214e-07],
                                                             [8.97897473e-08,   1.11532247e-07],
                                                             [1.26044169e-07,   8.92268117e-08],
                                                             [7.07198591e-08,   2.16122168e-07],
                                                             [1.33034792e-07,   5.62001829e-09],
                                                             [5.44457287e-08,   1.59588618e-07],
                                                             [1.68416656e-07,   6.84245651e-08],
                                                             [1.61102889e-07,   7.96405418e-08],
                                                             [5.20478275e-08,   1.08962656e-07],
                                                             [2.02645357e-07,   2.00804428e-08],
                                                             [8.44700981e-08,   1.84858971e-07],
                                                             [1.80260725e-08,   2.91792844e-08],
                                                             [7.64633759e-08,   1.15809924e-07],
                                                             [4.74818504e-08,   7.15624132e-08],
                                                             [5.23279673e-08,   2.02456645e-07],
                                                             [2.18767043e-08,   4.05917741e-08],
                                                             [2.02179336e-08,   7.67289096e-08],
                                                             [1.19470306e-07,   3.13404030e-08],
                                                             [1.50205344e-07,   1.09527020e-07],
                                                             [6.17546232e-08,   2.10887894e-07],
                                                             [1.34784014e-07,   5.68861136e-08],
                                                             [5.29553509e-08,   4.96070955e-08],
                                                             [5.89488225e-08,   8.23942956e-08],
                                                             [6.12684825e-08,   5.44750238e-08],
                                                             [1.24093639e-07,   9.46077805e-08],
                                                             [1.09090640e-07,   9.42362846e-09],
                                                             [1.66098575e-07,   3.82288370e-08],
                                                             [2.07519280e-07,   6.03546524e-10],
                                                             [4.85191926e-08,   4.80053254e-08],
                                                             [1.34845810e-07,   2.74405910e-08],
                                                             [1.37837138e-07,   7.32538222e-08],
                                                             [1.45776209e-07,   8.88444403e-08],
                                                             [1.43648428e-07,   1.81659886e-08],
                                                             [1.54977989e-07,   5.75297087e-08],
                                                             [8.50712728e-08,   1.21163430e-07],
                                                             [4.89231929e-08,   5.83887240e-08],
                                                             [1.58135378e-07,   6.38839160e-09],
                                                             [1.98885598e-08,   1.25504051e-07]]),
                                      'Stations': {'Azimuth': np.matrix([[71.3],
                                                                         [356.2],
                                                                         [321.8],
                                                                         [157.4],
                                                                         [126.4],
                                                                         [152.],
                                                                         [36.3],
                                                                         [159.6],
                                                                         [235.8],
                                                                         [23.8],
                                                                         [225.],
                                                                         [86.9],
                                                                         [330.8],
                                                                         [341.3],
                                                                         [99.],
                                                                         [30.9],
                                                                         [100.4],
                                                                         [191.7],
                                                                         [201.3],
                                                                         [264.1],
                                                                         [161.],
                                                                         [250.2],
                                                                         [261.5],
                                                                         [322.1],
                                                                         [347.6],
                                                                         [95.8],
                                                                         [308.9],
                                                                         [295.2],
                                                                         [164.2],
                                                                         [211.4],
                                                                         [97.1],
                                                                         [183.1],
                                                                         [221.4],
                                                                         [315.],
                                                                         [214.4],
                                                                         [122.9],
                                                                         [143.6],
                                                                         [9.3],
                                                                         [164.2],
                                                                         [242.],
                                                                         [162.9],
                                                                         [350.7],
                                                                         [212.6],
                                                                         [19.9],
                                                                         [32.6],
                                                                         [251.],
                                                                         [326.9],
                                                                         [27.7],
                                                                         [299.4]]),
                                                   'Name': ['S0411',
                                                            'S0559',
                                                            'S0578',
                                                            'S0121',
                                                            'S0129',
                                                            'S0122',
                                                            'S0539',
                                                            'S0095',
                                                            'S0105',
                                                            'S0669',
                                                            'S0244',
                                                            'S0362',
                                                            'S0453',
                                                            'S0531',
                                                            'S0329',
                                                            'S0671',
                                                            'S0308',
                                                            'S0142',
                                                            'S0167',
                                                            'S0320',
                                                            'S0223',
                                                            'S0324',
                                                            'S0289',
                                                            'S0452',
                                                            'S0403',
                                                            'S0331',
                                                            'S0549',
                                                            'S0422',
                                                            'S0017',
                                                            'S0272',
                                                            'S0330',
                                                            'S0065',
                                                            'S0110',
                                                            'S0501',
                                                            'S0085',
                                                            'S0204',
                                                            'S0048',
                                                            'S0587',
                                                            'S0197',
                                                            'S0213',
                                                            'S0043',
                                                            'S0584',
                                                            'S0192',
                                                            'S0668',
                                                            'S0485',
                                                            'S0295',
                                                            'S0630',
                                                            'S0617',
                                                            'S0399'],
                                                   'TakeOffAngle': np.matrix([[135.8],
                                                                              [133.3],
                                                                              [120.3],
                                                                              [130.5],
                                                                              [113.8],
                                                                              [128.9],
                                                                              [130.1],
                                                                              [126.9],
                                                                              [111.7],
                                                                              [115.6],
                                                                              [150.],
                                                                              [125.5],
                                                                              [149.],
                                                                              [135.8],
                                                                              [157.9],
                                                                              [113.1],
                                                                              [132.8],
                                                                              [137.],
                                                                              [140.],
                                                                              [147.1],
                                                                              [151.1],
                                                                              [169.5],
                                                                              [125.2],
                                                                              [146.1],
                                                                              [163.6],
                                                                              [147.1],
                                                                              [116.],
                                                                              [134.2],
                                                                              [117.5],
                                                                              [161.4],
                                                                              [152.4],
                                                                              [125.6],
                                                                              [122.8],
                                                                              [130.6],
                                                                              [122.2],
                                                                              [127.],
                                                                              [113.8],
                                                                              [128.8],
                                                                              [146.2],
                                                                              [128.9],
                                                                              [120.4],
                                                                              [128.8],
                                                                              [142.1],
                                                                              [116.6],
                                                                              [142.1],
                                                                              [151.1],
                                                                              [115.4],
                                                                              [121.],
                                                                              [149.]])}},
            'P/SVRMSAmplitudeRatio': {'Error': np.matrix([[199.44352088,   65.78836749],
                                                          [498.66364286,  126.0376226],
                                                          [170.54788088,   99.32601225],
                                                          [581.55286273,  107.20673309],
                                                          [299.81757325,  183.99169932],
                                                          [561.43914757,  100.68469001],
                                                          [535.28222675,  166.21167801],
                                                          [537.40417781,  121.47113115],
                                                          [8.7168497,  282.40010125],
                                                          [458.8678666,  260.90057961],
                                                          [441.37237125,   98.52095319],
                                                          [23.64324641,   72.74607526],
                                                          [290.87994937,   94.76871278],
                                                          [408.32861417,   97.84161933],
                                                          [229.10234866,   41.44481212],
                                                          [430.97483831,  282.43574838],
                                                          [176.3811002,   31.95404296],
                                                          [545.59795729,  107.08728715],
                                                          [521.90443116,  122.56590378],
                                                          [168.61291224,   34.22334376],
                                                          [656.48434059,  128.87831685],
                                                          [273.64737246,   50.74838333],
                                                          [58.39741578,   90.61669344],
                                                          [247.70818028,   87.05437793],
                                                          [153.82083499,   82.24809858],
                                                          [169.52032733,   30.10920064],
                                                          [70.87123312,  101.38836015],
                                                          [65.4973787,   39.08954545],
                                                          [387.03283146,  329.38174653],
                                                          [486.60131689,   99.72855995],
                                                          [200.05876369,   36.4930935],
                                                          [436.64287387,  168.46865908],
                                                          [171.55330901,  210.98214189],
                                                          [190.96870304,   68.91684015],
                                                          [198.48425104,  219.1351011],
                                                          [402.01014327,   64.41102206],
                                                          [353.40687635,  243.92963524],
                                                          [538.08763708,  170.25610269],
                                                          [672.27365927,  132.99578145],
                                                          [157.18188682,  103.70412146],
                                                          [436.84292331,  135.71248222],
                                                          [446.53274846,  137.10620566],
                                                          [472.25255867,  118.29843084],
                                                          [465.35862791,  277.85145281],
                                                          [502.06193039,  127.42983767],
                                                          [275.59479624,   56.66750035],
                                                          [158.49020081,  101.89559765],
                                                          [512.29010846,  192.12206575],
                                                          [64.43022752,   52.76830881]]),
                                      'Measured': np.matrix([[6.15648635e-08,   6.10910180e-08],
                                                             [1.53929061e-07,   3.32598867e-08],
                                                             [5.26452383e-08,   4.65008680e-08],
                                                             [1.79515359e-07,   2.92575305e-08],
                                                             [9.25485505e-08,   4.26968510e-08],
                                                             [1.73306602e-07,   3.01285097e-08],
                                                             [1.65232611e-07,   5.44752212e-08],
                                                             [1.65887399e-07,   4.64167501e-08],
                                                             [2.68984723e-09,   8.22336369e-08],
                                                             [1.41644867e-07,   2.56503856e-08],
                                                             [1.36243987e-07,   3.77473114e-09],
                                                             [7.29829366e-09,   2.72761234e-08],
                                                             [8.97897473e-08,   8.74405187e-08],
                                                             [1.26044169e-07,   2.81621016e-08],
                                                             [7.07198591e-08,   1.86697443e-09],
                                                             [1.33034792e-07,   2.76851899e-08],
                                                             [5.44457287e-08,   1.93996500e-08],
                                                             [1.68416656e-07,   4.08233390e-08],
                                                             [1.61102889e-07,   3.53735370e-08],
                                                             [5.20478275e-08,   3.03444373e-08],
                                                             [2.02645357e-07,   8.44220177e-08],
                                                             [8.44700981e-08,   4.43906998e-08],
                                                             [1.80260725e-08,   4.34086721e-08],
                                                             [7.64633759e-08,   5.89031954e-08],
                                                             [4.74818504e-08,   1.95303763e-07],
                                                             [5.23279673e-08,   2.02022616e-08],
                                                             [2.18767043e-08,   4.51642569e-08],
                                                             [2.02179336e-08,   4.46175305e-09],
                                                             [1.19470306e-07,   7.89715221e-08],
                                                             [1.50205344e-07,   9.45604516e-08],
                                                             [6.17546232e-08,   1.27064701e-08],
                                                             [1.34784014e-07,   8.02046930e-08],
                                                             [5.29553509e-08,   1.00111350e-07],
                                                             [5.89488225e-08,   1.48708951e-08],
                                                             [6.12684825e-08,   1.03675877e-07],
                                                             [1.24093639e-07,   1.77789343e-08],
                                                             [1.09090640e-07,   6.07719766e-08],
                                                             [1.66098575e-07,   2.33631683e-08],
                                                             [2.07519280e-07,   5.09298268e-08],
                                                             [4.85191926e-08,   7.39312077e-08],
                                                             [1.34845810e-07,   7.18078051e-08],
                                                             [1.37837138e-07,   2.98119360e-09],
                                                             [1.45776209e-07,   3.50940703e-08],
                                                             [1.43648428e-07,   2.54684784e-08],
                                                             [1.54977989e-07,   1.20640536e-07],
                                                             [8.50712728e-08,   1.80709960e-08],
                                                             [4.89231929e-08,   5.80056718e-08],
                                                             [1.58135378e-07,   3.01228634e-09],
                                                             [1.98885598e-08,   4.46245966e-08]]),
                                      'Stations': {'Azimuth': np.matrix([[71.3],
                                                                         [356.2],
                                                                         [321.8],
                                                                         [157.4],
                                                                         [126.4],
                                                                         [152.],
                                                                         [36.3],
                                                                         [159.6],
                                                                         [235.8],
                                                                         [23.8],
                                                                         [225.],
                                                                         [86.9],
                                                                         [330.8],
                                                                         [341.3],
                                                                         [99.],
                                                                         [30.9],
                                                                         [100.4],
                                                                         [191.7],
                                                                         [201.3],
                                                                         [264.1],
                                                                         [161.],
                                                                         [250.2],
                                                                         [261.5],
                                                                         [322.1],
                                                                         [347.6],
                                                                         [95.8],
                                                                         [308.9],
                                                                         [295.2],
                                                                         [164.2],
                                                                         [211.4],
                                                                         [97.1],
                                                                         [183.1],
                                                                         [221.4],
                                                                         [315.],
                                                                         [214.4],
                                                                         [122.9],
                                                                         [143.6],
                                                                         [9.3],
                                                                         [164.2],
                                                                         [242.],
                                                                         [162.9],
                                                                         [350.7],
                                                                         [212.6],
                                                                         [19.9],
                                                                         [32.6],
                                                                         [251.],
                                                                         [326.9],
                                                                         [27.7],
                                                                         [299.4]]),
                                                   'Name': ['S0411',
                                                            'S0559',
                                                            'S0578',
                                                            'S0121',
                                                            'S0129',
                                                            'S0122',
                                                            'S0539',
                                                            'S0095',
                                                            'S0105',
                                                            'S0669',
                                                            'S0244',
                                                            'S0362',
                                                            'S0453',
                                                            'S0531',
                                                            'S0329',
                                                            'S0671',
                                                            'S0308',
                                                            'S0142',
                                                            'S0167',
                                                            'S0320',
                                                            'S0223',
                                                            'S0324',
                                                            'S0289',
                                                            'S0452',
                                                            'S0403',
                                                            'S0331',
                                                            'S0549',
                                                            'S0422',
                                                            'S0017',
                                                            'S0272',
                                                            'S0330',
                                                            'S0065',
                                                            'S0110',
                                                            'S0501',
                                                            'S0085',
                                                            'S0204',
                                                            'S0048',
                                                            'S0587',
                                                            'S0197',
                                                            'S0213',
                                                            'S0043',
                                                            'S0584',
                                                            'S0192',
                                                            'S0668',
                                                            'S0485',
                                                            'S0295',
                                                            'S0630',
                                                            'S0617',
                                                            'S0399'],
                                                   'TakeOffAngle': np.matrix([[135.8],
                                                                              [133.3],
                                                                              [120.3],
                                                                              [130.5],
                                                                              [113.8],
                                                                              [128.9],
                                                                              [130.1],
                                                                              [126.9],
                                                                              [111.7],
                                                                              [115.6],
                                                                              [150.],
                                                                              [125.5],
                                                                              [149.],
                                                                              [135.8],
                                                                              [157.9],
                                                                              [113.1],
                                                                              [132.8],
                                                                              [137.],
                                                                              [140.],
                                                                              [147.1],
                                                                              [151.1],
                                                                              [169.5],
                                                                              [125.2],
                                                                              [146.1],
                                                                              [163.6],
                                                                              [147.1],
                                                                              [116.],
                                                                              [134.2],
                                                                              [117.5],
                                                                              [161.4],
                                                                              [152.4],
                                                                              [125.6],
                                                                              [122.8],
                                                                              [130.6],
                                                                              [122.2],
                                                                              [127.],
                                                                              [113.8],
                                                                              [128.8],
                                                                              [146.2],
                                                                              [128.9],
                                                                              [120.4],
                                                                              [128.8],
                                                                              [142.1],
                                                                              [116.6],
                                                                              [142.1],
                                                                              [151.1],
                                                                              [115.4],
                                                                              [121.],
                                                                              [149.]])}},
            'PAmplitude': {'Error': np.matrix([[0.10726012],
                                               [0.27344765],
                                               [0.09691162],
                                               [0.35718067],
                                               [0.17952063],
                                               [0.34472285],
                                               [0.29129286],
                                               [0.33373454],
                                               [0.04135252],
                                               [0.23277495],
                                               [0.28263826],
                                               [0.00745744],
                                               [0.15745542],
                                               [0.22222093],
                                               [0.15613884],
                                               [0.21035985],
                                               [0.12174298],
                                               [0.34246231],
                                               [0.3251488],
                                               [0.11620495],
                                               [0.41348737],
                                               [0.19043807],
                                               [0.06216849],
                                               [0.12848908],
                                               [0.09338317],
                                               [0.11092246],
                                               [0.04779726],
                                               [0.036516],
                                               [0.24932909],
                                               [0.31706832],
                                               [0.13521082],
                                               [0.28942851],
                                               [0.13641901],
                                               [0.10412258],
                                               [0.1515798],
                                               [0.24205006],
                                               [0.21343802],
                                               [0.29667059],
                                               [0.41772117],
                                               [0.12009894],
                                               [0.28222114],
                                               [0.24371905],
                                               [0.29490951],
                                               [0.24233485],
                                               [0.28802166],
                                               [0.18557921],
                                               [0.09807814],
                                               [0.26938513],
                                               [0.02769311]]),
                           'Measured': np.matrix([[-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.],
                                                  [-1.]]),
                           'Stations': {'Azimuth': np.matrix([[71.3],
                                                              [356.2],
                                                              [321.8],
                                                              [157.4],
                                                              [126.4],
                                                              [152.],
                                                              [36.3],
                                                              [159.6],
                                                              [235.8],
                                                              [23.8],
                                                              [225.],
                                                              [86.9],
                                                              [330.8],
                                                              [341.3],
                                                              [99.],
                                                              [30.9],
                                                              [100.4],
                                                              [191.7],
                                                              [201.3],
                                                              [264.1],
                                                              [161.],
                                                              [250.2],
                                                              [261.5],
                                                              [322.1],
                                                              [347.6],
                                                              [95.8],
                                                              [308.9],
                                                              [295.2],
                                                              [164.2],
                                                              [211.4],
                                                              [97.1],
                                                              [183.1],
                                                              [221.4],
                                                              [315.],
                                                              [214.4],
                                                              [122.9],
                                                              [143.6],
                                                              [9.3],
                                                              [164.2],
                                                              [242.],
                                                              [162.9],
                                                              [350.7],
                                                              [212.6],
                                                              [19.9],
                                                              [32.6],
                                                              [251.],
                                                              [326.9],
                                                              [27.7],
                                                              [299.4]]),
                                        'Name': ['S0411',
                                                 'S0559',
                                                 'S0578',
                                                 'S0121',
                                                 'S0129',
                                                 'S0122',
                                                 'S0539',
                                                 'S0095',
                                                 'S0105',
                                                 'S0669',
                                                 'S0244',
                                                 'S0362',
                                                 'S0453',
                                                 'S0531',
                                                 'S0329',
                                                 'S0671',
                                                 'S0308',
                                                 'S0142',
                                                 'S0167',
                                                 'S0320',
                                                 'S0223',
                                                 'S0324',
                                                 'S0289',
                                                 'S0452',
                                                 'S0403',
                                                 'S0331',
                                                 'S0549',
                                                 'S0422',
                                                 'S0017',
                                                 'S0272',
                                                 'S0330',
                                                 'S0065',
                                                 'S0110',
                                                 'S0501',
                                                 'S0085',
                                                 'S0204',
                                                 'S0048',
                                                 'S0587',
                                                 'S0197',
                                                 'S0213',
                                                 'S0043',
                                                 'S0584',
                                                 'S0192',
                                                 'S0668',
                                                 'S0485',
                                                 'S0295',
                                                 'S0630',
                                                 'S0617',
                                                 'S0399'],
                                        'TakeOffAngle': np.matrix([[135.8],
                                                                   [133.3],
                                                                   [120.3],
                                                                   [130.5],
                                                                   [113.8],
                                                                   [128.9],
                                                                   [130.1],
                                                                   [126.9],
                                                                   [111.7],
                                                                   [115.6],
                                                                   [150.],
                                                                   [125.5],
                                                                   [149.],
                                                                   [135.8],
                                                                   [157.9],
                                                                   [113.1],
                                                                   [132.8],
                                                                   [137.],
                                                                   [140.],
                                                                   [147.1],
                                                                   [151.1],
                                                                   [169.5],
                                                                   [125.2],
                                                                   [146.1],
                                                                   [163.6],
                                                                   [147.1],
                                                                   [116.],
                                                                   [134.2],
                                                                   [117.5],
                                                                   [161.4],
                                                                   [152.4],
                                                                   [125.6],
                                                                   [122.8],
                                                                   [130.6],
                                                                   [122.2],
                                                                   [127.],
                                                                   [113.8],
                                                                   [128.8],
                                                                   [146.2],
                                                                   [128.9],
                                                                   [120.4],
                                                                   [128.8],
                                                                   [142.1],
                                                                   [116.6],
                                                                   [142.1],
                                                                   [151.1],
                                                                   [115.4],
                                                                   [121.],
                                                                   [149.]])}},
            'PPolarity': {'Error': np.matrix([[0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.01],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001],
                                              [0.001]]),
                          'Measured': np.matrix([[-1],
                                                 [-1],
                                                 [-1],
                                                 [1],
                                                 [1],
                                                 [1],
                                                 [-1],
                                                 [1],
                                                 [-1],
                                                 [-1],
                                                 [1],
                                                 [-1],
                                                 [-1],
                                                 [-1],
                                                 [1],
                                                 [-1],
                                                 [1],
                                                 [1],
                                                 [1],
                                                 [1],
                                                 [1],
                                                 [1],
                                                 [1],
                                                 [-1],
                                                 [-1],
                                                 [1],
                                                 [-1],
                                                 [-1],
                                                 [1],
                                                 [1],
                                                 [1],
                                                 [1],
                                                 [1],
                                                 [-1],
                                                 [1],
                                                 [1],
                                                 [1],
                                                 [-1],
                                                 [1],
                                                 [1],
                                                 [1],
                                                 [-1],
                                                 [1],
                                                 [-1],
                                                 [-1],
                                                 [1],
                                                 [-1],
                                                 [-1],
                                                 [-1]]),
                          'Stations': {'Azimuth': np.matrix([[71.3],
                                                             [356.2],
                                                             [321.8],
                                                             [157.4],
                                                             [126.4],
                                                             [152.],
                                                             [36.3],
                                                             [159.6],
                                                             [235.8],
                                                             [23.8],
                                                             [225.],
                                                             [86.9],
                                                             [330.8],
                                                             [341.3],
                                                             [99.],
                                                             [30.9],
                                                             [100.4],
                                                             [191.7],
                                                             [201.3],
                                                             [264.1],
                                                             [161.],
                                                             [250.2],
                                                             [261.5],
                                                             [322.1],
                                                             [347.6],
                                                             [95.8],
                                                             [308.9],
                                                             [295.2],
                                                             [164.2],
                                                             [211.4],
                                                             [97.1],
                                                             [183.1],
                                                             [221.4],
                                                             [315.],
                                                             [214.4],
                                                             [122.9],
                                                             [143.6],
                                                             [9.3],
                                                             [164.2],
                                                             [242.],
                                                             [162.9],
                                                             [350.7],
                                                             [212.6],
                                                             [19.9],
                                                             [32.6],
                                                             [251.],
                                                             [326.9],
                                                             [27.7],
                                                             [299.4]]),
                                       'Name': ['S0411',
                                                'S0559',
                                                'S0578',
                                                'S0121',
                                                'S0129',
                                                'S0122',
                                                'S0539',
                                                'S0095',
                                                'S0105',
                                                'S0669',
                                                'S0244',
                                                'S0362',
                                                'S0453',
                                                'S0531',
                                                'S0329',
                                                'S0671',
                                                'S0308',
                                                'S0142',
                                                'S0167',
                                                'S0320',
                                                'S0223',
                                                'S0324',
                                                'S0289',
                                                'S0452',
                                                'S0403',
                                                'S0331',
                                                'S0549',
                                                'S0422',
                                                'S0017',
                                                'S0272',
                                                'S0330',
                                                'S0065',
                                                'S0110',
                                                'S0501',
                                                'S0085',
                                                'S0204',
                                                'S0048',
                                                'S0587',
                                                'S0197',
                                                'S0213',
                                                'S0043',
                                                'S0584',
                                                'S0192',
                                                'S0668',
                                                'S0485',
                                                'S0295',
                                                'S0630',
                                                'S0617',
                                                'S0399'],
                                       'TakeOffAngle': np.matrix([[135.8],
                                                                  [133.3],
                                                                  [120.3],
                                                                  [130.5],
                                                                  [113.8],
                                                                  [128.9],
                                                                  [130.1],
                                                                  [126.9],
                                                                  [111.7],
                                                                  [115.6],
                                                                  [150.],
                                                                  [125.5],
                                                                  [149.],
                                                                  [135.8],
                                                                  [157.9],
                                                                  [113.1],
                                                                  [132.8],
                                                                  [137.],
                                                                  [140.],
                                                                  [147.1],
                                                                  [151.1],
                                                                  [169.5],
                                                                  [125.2],
                                                                  [146.1],
                                                                  [163.6],
                                                                  [147.1],
                                                                  [116.],
                                                                  [134.2],
                                                                  [117.5],
                                                                  [161.4],
                                                                  [152.4],
                                                                  [125.6],
                                                                  [122.8],
                                                                  [130.6],
                                                                  [122.2],
                                                                  [127.],
                                                                  [113.8],
                                                                  [128.8],
                                                                  [146.2],
                                                                  [128.9],
                                                                  [120.4],
                                                                  [128.8],
                                                                  [142.1],
                                                                  [116.6],
                                                                  [142.1],
                                                                  [151.1],
                                                                  [115.4],
                                                                  [121.],
                                                                  [149.]])}},
            'SH/SVRMSAmplitudeRatio': {'Error': np.matrix([[21.62372527,   65.78836749],
                                                           [8.70323068,  126.0376226],
                                                           [5.594451,   99.32601225],
                                                           [9.46889106,  107.20673309],
                                                           [46.19534894,  183.99169932],
                                                           [12.51752148,  100.68469001],
                                                           [24.50181316,  166.21167801],
                                                           [15.16310774,  121.47113115],
                                                           [19.63458484,  282.40010125],
                                                           [51.99317775,  260.90057961],
                                                           [16.29669511,   98.52095319],
                                                           [15.1128682,   72.74607526],
                                                           [16.24893782,   94.76871278],
                                                           [14.33273385,   97.84161933],
                                                           [32.43160921,   41.44481212],
                                                           [65.87107192,  282.43574838],
                                                           [20.8928473,   31.95404296],
                                                           [9.62307117,  107.08728715],
                                                           [10.93144098,  122.56590378],
                                                           [17.03147822,   34.22334376],
                                                           [3.8047885,  128.87831685],
                                                           [26.74897284,   50.74838333],
                                                           [4.31885618,   90.61669344],
                                                           [17.01495775,   87.05437793],
                                                           [9.95501639,   82.24809858],
                                                           [29.9659421,   30.10920064],
                                                           [5.49772458,  101.38836015],
                                                           [10.53896346,   39.08954545],
                                                           [49.11239697,  329.38174653],
                                                           [15.53669462,   99.72855995],
                                                           [31.84654865,   36.4930935],
                                                           [5.42992212,  168.46865908],
                                                           [9.59333439,  210.98214189],
                                                           [12.80812676,   68.91684015],
                                                           [7.33105253,  219.1351011],
                                                           [16.58254691,   64.41102206],
                                                           [68.39544041,  243.92963524],
                                                           [10.79765277,  170.25610269],
                                                           [1.52617281,  132.99578145],
                                                           [6.83095756,  103.70412146],
                                                           [6.98502622,  135.71248222],
                                                           [12.68138407,  137.10620566],
                                                           [12.76140636,  118.29843084],
                                                           [47.47025807,  277.85145281],
                                                           [8.68587556,  127.42983767],
                                                           [19.00739329,   56.66750035],
                                                           [6.83572288,  101.89559765],
                                                           [19.83893775,  192.12206575],
                                                           [19.32498077,   52.76830881]]),
                                       'Measured': np.matrix([[1.62124698e-07,   6.10910180e-08],
                                                              [6.52698738e-08,   3.32598867e-08],
                                                              [6.39935037e-08,   4.65008680e-08],
                                                              [2.82238355e-09,   2.92575305e-08],
                                                              [4.98021494e-08,   4.26968510e-08],
                                                              [1.06897427e-08,   3.01285097e-08],
                                                              [4.83737361e-08,   5.44752212e-08],
                                                              [1.33617621e-08,   4.64167501e-08],
                                                              [1.11679455e-08,   8.22336369e-08],
                                                              [9.51630122e-09,   2.56503856e-08],
                                                              [1.08537209e-07,   3.77473114e-09],
                                                              [1.42938214e-07,   2.72761234e-08],
                                                              [1.11532247e-07,   8.74405187e-08],
                                                              [8.92268117e-08,   2.81621016e-08],
                                                              [2.16122168e-07,   1.86697443e-09],
                                                              [5.62001829e-09,   2.76851899e-08],
                                                              [1.59588618e-07,   1.93996500e-08],
                                                              [6.84245651e-08,   4.08233390e-08],
                                                              [7.96405418e-08,   3.53735370e-08],
                                                              [1.08962656e-07,   3.03444373e-08],
                                                              [2.00804428e-08,   8.44220177e-08],
                                                              [1.84858971e-07,   4.43906998e-08],
                                                              [2.91792844e-08,   4.34086721e-08],
                                                              [1.15809924e-07,   5.89031954e-08],
                                                              [7.15624132e-08,   1.95303763e-07],
                                                              [2.02456645e-07,   2.02022616e-08],
                                                              [4.05917741e-08,   4.51642569e-08],
                                                              [7.67289096e-08,   4.46175305e-09],
                                                              [3.13404030e-08,   7.89715221e-08],
                                                              [1.09527020e-07,   9.45604516e-08],
                                                              [2.10887894e-07,   1.27064701e-08],
                                                              [5.68861136e-08,   8.02046930e-08],
                                                              [4.96070955e-08,   1.00111350e-07],
                                                              [8.23942956e-08,   1.48708951e-08],
                                                              [5.44750238e-08,   1.03675877e-07],
                                                              [9.46077805e-08,   1.77789343e-08],
                                                              [9.42362846e-09,   6.07719766e-08],
                                                              [3.82288370e-08,   2.33631683e-08],
                                                              [6.03546524e-10,   5.09298268e-08],
                                                              [4.80053254e-08,   7.39312077e-08],
                                                              [2.74405910e-08,   7.18078051e-08],
                                                              [7.32538222e-08,   2.98119360e-09],
                                                              [8.88444403e-08,   3.50940703e-08],
                                                              [1.81659886e-08,   2.54684784e-08],
                                                              [5.75297087e-08,   1.20640536e-07],
                                                              [1.21163430e-07,   1.80709960e-08],
                                                              [5.83887240e-08,   5.80056718e-08],
                                                              [6.38839160e-09,   3.01228634e-09],
                                                              [1.25504051e-07,   4.46245966e-08]]),
                                       'Stations': {'Azimuth': np.matrix([[71.3],
                                                                          [356.2],
                                                                          [321.8],
                                                                          [157.4],
                                                                          [126.4],
                                                                          [152.],
                                                                          [36.3],
                                                                          [159.6],
                                                                          [235.8],
                                                                          [23.8],
                                                                          [225.],
                                                                          [86.9],
                                                                          [330.8],
                                                                          [341.3],
                                                                          [99.],
                                                                          [30.9],
                                                                          [100.4],
                                                                          [191.7],
                                                                          [201.3],
                                                                          [264.1],
                                                                          [161.],
                                                                          [250.2],
                                                                          [261.5],
                                                                          [322.1],
                                                                          [347.6],
                                                                          [95.8],
                                                                          [308.9],
                                                                          [295.2],
                                                                          [164.2],
                                                                          [211.4],
                                                                          [97.1],
                                                                          [183.1],
                                                                          [221.4],
                                                                          [315.],
                                                                          [214.4],
                                                                          [122.9],
                                                                          [143.6],
                                                                          [9.3],
                                                                          [164.2],
                                                                          [242.],
                                                                          [162.9],
                                                                          [350.7],
                                                                          [212.6],
                                                                          [19.9],
                                                                          [32.6],
                                                                          [251.],
                                                                          [326.9],
                                                                          [27.7],
                                                                          [299.4]]),
                                                    'Name': ['S0411',
                                                             'S0559',
                                                             'S0578',
                                                             'S0121',
                                                             'S0129',
                                                             'S0122',
                                                             'S0539',
                                                             'S0095',
                                                             'S0105',
                                                             'S0669',
                                                             'S0244',
                                                             'S0362',
                                                             'S0453',
                                                             'S0531',
                                                             'S0329',
                                                             'S0671',
                                                             'S0308',
                                                             'S0142',
                                                             'S0167',
                                                             'S0320',
                                                             'S0223',
                                                             'S0324',
                                                             'S0289',
                                                             'S0452',
                                                             'S0403',
                                                             'S0331',
                                                             'S0549',
                                                             'S0422',
                                                             'S0017',
                                                             'S0272',
                                                             'S0330',
                                                             'S0065',
                                                             'S0110',
                                                             'S0501',
                                                             'S0085',
                                                             'S0204',
                                                             'S0048',
                                                             'S0587',
                                                             'S0197',
                                                             'S0213',
                                                             'S0043',
                                                             'S0584',
                                                             'S0192',
                                                             'S0668',
                                                             'S0485',
                                                             'S0295',
                                                             'S0630',
                                                             'S0617',
                                                             'S0399'],
                                                    'TakeOffAngle': np.matrix([[135.8],
                                                                               [133.3],
                                                                               [120.3],
                                                                               [130.5],
                                                                               [113.8],
                                                                               [128.9],
                                                                               [130.1],
                                                                               [126.9],
                                                                               [111.7],
                                                                               [115.5],
                                                                               [150.],
                                                                               [125.5],
                                                                               [149.],
                                                                               [135.8],
                                                                               [157.9],
                                                                               [113.1],
                                                                               [132.8],
                                                                               [137.],
                                                                               [140.],
                                                                               [147.1],
                                                                               [151.1],
                                                                               [169.5],
                                                                               [125.2],
                                                                               [146.1],
                                                                               [163.6],
                                                                               [147.1],
                                                                               [116.],
                                                                               [134.2],
                                                                               [117.5],
                                                                               [161.4],
                                                                               [152.4],
                                                                               [125.6],
                                                                               [122.8],
                                                                               [130.6],
                                                                               [122.2],
                                                                               [127.],
                                                                               [113.8],
                                                                               [128.8],
                                                                               [146.2],
                                                                               [128.9],
                                                                               [120.4],
                                                                               [128.8],
                                                                               [142.1],
                                                                               [116.6],
                                                                               [142.1],
                                                                               [151.1],
                                                                               [115.4],
                                                                               [121.],
                                                                               [149.]])}},
            'UID': 'RandSamplingr8002'}


def probability_cython_benchmarks(n=1):
    x = np.random.randn(198, 200, 50)
    a_p = np.matrix([[-0.0801, -0.5611, -0.3588, -0.2998, 0.2398, 0.6345],
                    [-0.0877, -0.4819, -0.4304, -0.2907, 0.2747, 0.6441],
                    [-0.1176, -0.1983, -0.6841, -0.2160, 0.4011, 0.5209],
                    [-0.1336, -0.0753, -0.7911, -0.1419, 0.4598, 0.3452],
                    [0.0405, 0.7019, 0.2576, 0.2383, 0.1444, 0.6014],
                    [0.0573, 0.4235, 0.5192, 0.2203, 0.2440, 0.6631],
                    [-0.1057, -0.6607, -0.2336, 0.3737, 0.2222, -0.5556],
                    [0.0662, 0.2759, 0.6578, 0.1912, 0.2952, 0.6025],
                    [-0.4350, -0.0266, -0.5384, -0.1522, 0.6844, 0.1694],
                    [-0.4368, -0.0248, -0.5384, 0.1472, 0.6858, -0.1634],
                    [-0.4199, -0.0575, -0.5227, 0.2196, 0.6625, -0.2451],
                    [-0.7223, -0.0185, -0.2591, -0.1636, 0.6118, 0.0980],
                    [-0.7306, -0.0026, -0.2668, -0.0614, 0.6244, 0.0371],
                    [0.3926, 0.1474, 0.4599, -0.3403, 0.6010, -0.3683],
                    [0.0233, 0.5064, 0.4703, -0.1535, 0.1480, -0.6902],
                    [0.0292, 0.2835, 0.6873, -0.1287, 0.2004, -0.6242],
                    [0.0310, 0.2145, 0.7545, -0.1152, 0.2161, -0.5690],
                    [-0.6686, -0.1037, -0.2277, 0.3724, 0.5518, -0.2173],
                    [-0.6420, -0.1448, -0.2132, 0.4311, 0.5232, -0.2485],
                    [0.0364, 0.0396, 0.9240, -0.0537, 0.2594, -0.2705],
                    [0.4236, 0.0555, 0.5209, -0.2168, 0.6643, -0.2405],
                    [0.0330, 0.1389, 0.8280, -0.0958, 0.2339, -0.4797],
                    [-0.0289, -0.3655, -0.6057, -0.1453, 0.1870, 0.6654],
                    [-0.0226, -0.5881, -0.3892, -0.1632, 0.1328, 0.6766],
                    [-0.0185, -0.7223, -0.2591, -0.1636, 0.0980, 0.6118],
                    [-0.0207, -0.6535, -0.3257, -0.1646, 0.1162, 0.6525],
                    [-0.3655, -0.0289, -0.6057, -0.1453, 0.6654, 0.1870],
                    [-0.2661, -0.3497, -0.3841, 0.4315, 0.4522, -0.5183],
                    [-0.3725, -0.0048, -0.6227, 0.0600, 0.6811, -0.0776],
                    [-0.3676, -0.0268, -0.6057, 0.1403, 0.6673, -0.1800],
                    [-0.3438, -0.1039, -0.5523, 0.2673, 0.6162, -0.3388],
                    [-0.5596, -0.0816, -0.3588, 0.3022, 0.6337, -0.2420],
                    [-0.5251, -0.3370, -0.1379, 0.5949, 0.3806, -0.3049],
                    [-0.5167, -0.1722, -0.3111, 0.4219, 0.5670, -0.3273],
                    [0.0046, 0.4414, 0.5540, 0.0634, 0.0710, 0.6994],
                    [-0.5967, -0.0039, -0.3995, 0.0679, 0.6904, -0.0556],
                    [-0.5897, -0.0211, -0.3892, 0.1576, 0.6775, -0.1280],
                    [-0.4268, -0.4268, -0.1464, -0.6036, 0.3536, 0.3536],
                    [-0.3867, -0.4941, -0.1192, -0.6182, 0.3037, 0.3432],
                    [-0.5753, -0.0473, -0.3773, -0.2333, 0.6589, 0.1889],
                    [-0.4559, -0.4434, -0.1007, 0.6359, 0.3030, -0.2988],
                    [0.0195, 0.6548, 0.3257, -0.1599, 0.1128, -0.6531],
                    [0.5698, 0.3166, 0.1136, -0.6006, 0.3599, -0.2682],
                    [-0.0610, -0.3487, -0.5903, 0.2063, 0.2684, -0.6416],
                    [-0.0476, -0.5716, -0.3807, 0.2333, 0.1904, -0.6598],
                    [-0.0435, -0.6406, -0.3159, 0.2360, 0.1657, -0.6362],
                    [-0.0168, -0.7700, -0.2132, -0.1608, 0.0846, 0.5730],
                    [-0.0653, -0.2769, -0.6578, 0.1901, 0.2931, -0.6036],
                    [0.7752, 0.0029, 0.2219, 0.0671, 0.5865, 0.0359],
                    [0.6597, 0.1788, 0.1616, -0.4856, 0.4617, -0.2403],
                    [0.4841, 0.0872, 0.4287, -0.2906, 0.6442, -0.2735],
                    [0.1415, 0.0358, 0.8227, -0.1006, 0.4825, -0.2427],
                    [0.4447, 0.1847, 0.3706, -0.4053, 0.5741, -0.3700],
                    [-0.6391, -0.0434, -0.3176, -0.2354, 0.6371, 0.1660],
                    [0.3344, 0.4394, 0.2262, -0.5421, 0.3890, -0.4459],
                    [0.3692, 0.3640, 0.2668, -0.5184, 0.4438, -0.4407],
                    [0.0974, 0.4096, 0.4930, 0.2825, 0.3099, 0.6355],
                    [0.1049, 0.3359, 0.5592, 0.2655, 0.3425, 0.6129],
                    [0.1197, 0.1946, 0.6857, 0.2158, 0.4051, 0.5167],
                    [0.1374, 0.0758, 0.7868, 0.1443, 0.4650, 0.3454],
                    [-0.5228, -0.2582, -0.2190, -0.5196, 0.4785, 0.3363],
                    [0.1454, 0.0060, 0.8486, 0.0418, 0.4968, 0.1011],
                    [0.0707, 0.2038, 0.7254, 0.1698, 0.3203, 0.5438],
                    [0.4434, 0.4559, 0.1007, -0.6359, 0.2988, -0.3030],
                    [-0.4018, -0.4018, -0.1963, -0.5683, 0.3972, 0.3972],
                    [-0.3711, -0.4609, -0.1680, -0.5848, 0.3531, 0.3936],
                    [0.4087, 0.5077, 0.0835, -0.6442, 0.2613, -0.2913],
                    [-0.5165, -0.1708, -0.3127, -0.4200, 0.5684, 0.3268],
                    [0.4961, 0.3117, 0.1922, 0.5561, 0.4367, 0.3461],
                    [0.4652, 0.3667, 0.1680, 0.5841, 0.3954, 0.3511],
                    [-0.5065, -0.0249, -0.4686, -0.1588, 0.6890, 0.1527],
                    [-0.4160, -0.2485, -0.3356, -0.4547, 0.5284, 0.4084],
                    [-0.3658, -0.3658, -0.2684, -0.5174, 0.4431, 0.4431],
                    [0.0043, 0.5132, 0.4826, -0.0661, 0.0640, -0.7038],
                    [0.0031, 0.7301, 0.2668, -0.0668, 0.0404, -0.6242],
                    [0.0057, 0.2176, 0.7767, -0.0498, 0.0942, -0.5814],
                    [0.0053, 0.2882, 0.7066, -0.0551, 0.0863, -0.6381],
                    [0.0046, 0.4414, 0.5540, -0.0634, 0.0710, -0.6994],
                    [-0.1258, -0.5337, -0.3405, 0.3665, 0.2927, -0.6029],
                    [0.3744, 0.2020, 0.4235, 0.3890, 0.5632, 0.4137],
                    [-0.0965, -0.7127, -0.1908, 0.3709, 0.1919, -0.5215],
                    [-0.0731, -0.6238, -0.3030, -0.3021, 0.2105, 0.6149],
                    [-0.0664, -0.6926, -0.2410, -0.3032, 0.1789, 0.5778],
                    [-0.4421, -0.0039, -0.5540, -0.0591, 0.6999, 0.0662],
                    [0.5170, 0.3439, 0.1391, -0.5963, 0.3793, -0.3093],
                    [0.0894, 0.4819, 0.4287, 0.2935, 0.2768, 0.6428],
                    [0.0824, 0.5537, 0.3639, 0.3022, 0.2449, 0.6348],
                    [0.0630, 0.7365, 0.2005, 0.3046, 0.1589, 0.5434],
                    [0.0756, 0.6230, 0.3014, 0.3068, 0.2134, 0.6129],
                    [0.7145, 0.0187, 0.2668, -0.1636, 0.6174, -0.1000],
                    [0.1250, 0.5395, 0.3356, -0.3672, 0.2896, -0.6017],
                    [0.1360, 0.4612, 0.4029, -0.3541, 0.3310, -0.6096],
                    [0.1037, 0.6686, 0.2277, -0.3724, 0.2173, -0.5518],
                    [0.6375, 0.1450, 0.2175, -0.4300, 0.5266, -0.2512],
                    [0.4414, 0.0046, 0.5540, 0.0634, 0.6994, 0.0710],
                    [0.4352, 0.0247, 0.5401, 0.1466, 0.6856, 0.1633],
                    [0.3264, 0.3264, 0.3472, 0.4616, 0.4761, 0.4761],
                    [-0.2634, -0.6058, -0.1308, -0.5649, 0.2625, 0.3981],
                    [-0.3166, -0.5698, -0.1136, 0.6006, 0.2682, -0.3599],
                    [-0.2840, -0.5582, -0.1577, -0.5631, 0.2993, 0.4196],
                    [-0.4061, -0.3976, -0.1963, 0.5683, 0.3993, -0.3951],
                    [-0.3702, -0.4631, -0.1667, 0.5855, 0.3514, -0.3930],
                    [-0.4922, -0.2223, -0.2855, 0.4678, 0.5302, -0.3563],
                    [0.0381, 0.0058, 0.9561, -0.0211, 0.2699, -0.1058],
                    [0.0027, 0.7243, 0.2730, -0.0626, -0.0385, 0.6289],
                    [0.0033, 0.5904, 0.4063, -0.0628, -0.0521, 0.6926],
                    [0.0050, 0.2154, 0.7796, -0.0466, -0.0887, 0.5795],
                    [0.3371, 0.4337, 0.2291, 0.5408, 0.3931, 0.4458],
                    [0.0055, 0.0870, 0.9076, -0.0309, -0.0998, 0.3973],
                    [-0.1570, -0.5793, -0.2637, 0.4265, 0.2878, -0.5528],
                    [-0.1450, -0.6375, -0.2175, 0.4300, 0.2512, -0.5266],
                    [0.3370, 0.5251, 0.1379, -0.5949, 0.3049, -0.3806],
                    [0.3653, 0.4667, 0.1680, -0.5839, 0.3504, -0.3960],
                    [-0.2172, -0.3020, -0.4808, 0.3622, 0.4570, -0.5389],
                    [0.4342, 0.3351, 0.2306, -0.5395, 0.4475, -0.3932],
                    [0.1872, 0.4439, 0.3689, 0.4077, 0.3716, 0.5723],
                    [0.1731, 0.5110, 0.3159, 0.4206, 0.3307, 0.5682],
                    [0.1591, 0.5772, 0.2637, 0.4285, 0.2897, 0.5518],
                    [0.1340, 0.6887, 0.1773, 0.4296, 0.2179, 0.4942],
                    [0.2056, 0.5519, 0.2425, -0.4764, 0.3158, -0.5173],
                    [0.1947, 0.1180, 0.6873, -0.2144, 0.5173, -0.4027],
                    [0.2179, 0.3030, 0.4791, 0.3634, 0.4569, 0.5388],
                    [-0.1259, -0.5386, -0.3356, -0.3682, 0.2906, 0.6012],
                    [-0.1157, -0.6004, -0.2840, -0.3727, 0.2563, 0.5839],
                    [-0.1591, -0.3269, -0.5140, -0.3225, 0.4044, 0.5797],
                    [-0.2869, -0.5515, -0.1616, 0.5626, 0.3045, -0.4222],
                    [-0.2379, -0.5862, -0.1759, -0.5281, 0.2893, 0.4542],
                    [-0.2776, -0.4648, -0.2576, -0.5080, 0.3782, 0.4893],
                    [-0.3248, -0.3248, -0.3505, -0.4593, 0.4771, 0.4771],
                    [0.0062, 0.0062, 0.9876, 0.0088, -0.1108, -0.1108],
                    [0.6230, 0.0756, 0.3014, 0.3068, 0.6129, 0.2134],
                    [0.0061, 0.0071, 0.9868, -0.0093, -0.1097, 0.1185],
                    [0.0049, 0.2184, 0.7767, 0.0462, -0.0871, -0.5825],
                    [0.6632, 0.0029, 0.3339, -0.0623, 0.6655, -0.0442],
                    [0.6406, 0.0435, 0.3159, -0.2360, 0.6362, -0.1657],
                    [-0.7511, -0.0357, -0.2132, -0.2316, 0.5659, 0.1234],
                    [-0.7401, -0.0608, -0.1991, -0.3001, 0.5428, 0.1557],
                    [-0.7759, -0.0023, -0.2219, -0.0594, 0.5867, 0.0318],
                    [0.2759, 0.0662, 0.6578, 0.1912, 0.6025, 0.2952],
                    [-0.7708, -0.0160, -0.2132, 0.1571, 0.5733, -0.0826],
                    [-0.7754, -0.0027, -0.2219, 0.0651, 0.5866, -0.0348],
                    [-0.7393, -0.0616, -0.1991, 0.3018, 0.5426, -0.1566],
                    [-0.6004, -0.1157, -0.2840, -0.3727, 0.5839, 0.2563],
                    [0.1346, 0.4642, 0.4012, 0.3535, 0.3286, 0.6103],
                    [-0.6238, -0.0731, -0.3030, -0.3021, 0.6149, 0.2105],
                    [-0.1847, -0.4447, -0.3706, 0.4053, 0.3700, -0.5741],
                    [0.0269, 0.3590, 0.6142, 0.1389, 0.1817, 0.6640],
                    [0.0346, 0.0846, 0.8808, 0.0765, 0.2469, 0.3861],
                    [-0.6181, -0.1884, -0.1935, 0.4825, 0.4891, -0.2700],
                    [0.4842, 0.2287, 0.2871, -0.4706, 0.5273, -0.3624],
                    [-0.5132, -0.0043, -0.4826, 0.0661, 0.7038, -0.0640],
                    [0.0290, 0.3569, 0.6142, -0.1438, -0.1886, 0.6621],
                    [-0.0739, -0.6231, -0.3030, 0.3034, 0.2116, -0.6145],
                    [0.6076, 0.1961, 0.1963, -0.4881, 0.4884, -0.2775],
                    [0.6607, 0.1057, 0.2336, -0.3737, 0.5556, -0.2222],
                    [0.3117, 0.4961, 0.1922, -0.5561, 0.3461, -0.4367],
                    [0.5716, 0.0476, 0.3807, -0.2333, 0.6598, -0.1904],
                    [0.5118, 0.1706, 0.3176, -0.4179, 0.5702, -0.3292],
                    [0.5337, 0.1258, 0.3405, -0.3665, 0.6029, -0.2927],
                    [-0.0026, -0.7306, -0.2668, -0.0614, 0.0371, 0.6244],
                    [0.5827, 0.0212, 0.3960, 0.1572, 0.6794, 0.1296],
                    [0.5828, 0.0228, 0.3943, -0.1632, 0.6780, -0.1342],
                    [0.7654, 0.0171, 0.2175, -0.1618, 0.5770, -0.0862],
                    [-0.4135, -0.5029, -0.0835, -0.6449, 0.2628, 0.2899],
                    [0.7526, 0.0370, 0.2104, 0.2360, 0.5627, 0.1248],
                    [0.7365, 0.0630, 0.2005, 0.3046, 0.5434, 0.1589],
                    [-0.6038, -0.2666, -0.1296, 0.5674, 0.3956, -0.2628],
                    [-0.5728, -0.3136, -0.1136, 0.5994, 0.3608, -0.2670],
                    [-0.0029, -0.6632, -0.3339, -0.0623, 0.0442, 0.6655],
                    [0.0049, 0.3657, 0.6294, 0.0598, 0.0785, 0.6785],
                    [-0.0753, -0.1365, -0.7882, 0.1434, 0.3445, -0.4639],
                    [-0.0753, -0.1336, -0.7911, -0.1419, 0.3452, 0.4598],
                    [-0.0858, -0.0056, -0.9086, -0.0309, 0.3950, 0.1007],
                    [-0.0651, -0.2737, -0.6611, -0.1888, 0.2934, 0.6016],
                    [0.0808, 0.0808, 0.8384, 0.1142, 0.3680, 0.3680],
                    [-0.0399, -0.0399, -0.9203, -0.0564, 0.2709, 0.2709],
                    [0.0870, 0.0064, 0.9066, 0.0334, 0.3972, 0.1079],
                    [0.0846, 0.0346, 0.8808, 0.0765, 0.3861, 0.2469],
                    [0.0870, 0.0055, 0.9076, -0.0309, 0.3973, -0.0998],
                    [0.0758, 0.1345, 0.7896, -0.1428, 0.3461, -0.4609],
                    [0.0664, 0.2741, 0.6595, -0.1908, 0.2959, -0.6013],
                    [0.0703, 0.2058, 0.7239, -0.1701, 0.3190, -0.5459],
                    [0.0311, 0.2848, 0.6841, -0.1332, -0.2064, 0.6242],
                    [-0.6655, -0.1743, -0.1603, 0.4816, 0.4619, -0.2363],
                    [0.0358, 0.1415, 0.8227, -0.1006, -0.2427, 0.4825],
                    [0.0378, 0.0849, 0.8774, -0.0801, -0.2574, 0.3859],
                    [0.4096, 0.0974, 0.4930, 0.2825, 0.6355, 0.3099],
                    [0.6030, 0.2662, 0.1308, 0.5666, 0.3971, 0.2639],
                    [-0.5035, -0.4111, -0.0855, -0.6434, -0.2934, -0.2651],
                    [-0.5376, -0.3627, -0.0996, -0.6245, -0.3273, -0.2689],
                    [0.2790, 0.2889, 0.4321, -0.4015, 0.4910, -0.4997],
                    [0.3020, 0.2172, 0.4808, -0.3622, 0.5389, -0.4570],
                    [0.6887, 0.1340, 0.1773, 0.4296, 0.4942, 0.2179],
                    [0.7136, 0.0956, 0.1908, 0.3693, 0.5218, 0.1910],
                    [0.6400, 0.0440, 0.3159, 0.2375, 0.6359, 0.1668],
                    [0.3646, 0.0043, 0.6311, -0.0560, 0.6784, -0.0737],
                    [0.4852, 0.3933, 0.1215, -0.6178, 0.3434, -0.3092],
                    [0.6536, 0.0191, 0.3274, 0.1580, 0.6541, 0.1118]])
    mt = np.random.randn(6, 1000)
    p_amplitude = a_p*mt
    error_polarity = np.matrix([[0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0100],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.5000],
                               [0.0010],
                               [0.0010],
                               [0.5000],
                               [0.5000],
                               [0.0500],
                               [0.0010],
                               [0.5000],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0100],
                               [0.1000],
                               [0.0010],
                               [0.0010],
                               [0.0100],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.1000],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0100],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0100],
                               [0.0100],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0100],
                               [0.5000],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0100],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.5000],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.1000],
                               [0.0010],
                               [0.1000],
                               [0.0010],
                               [0.0100],
                               [0.0010],
                               [0.0010],
                               [0.5000],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.5000],
                               [0.5000],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0100],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010],
                               [0.0010]])
    print('Polarity Tests')
    print('\nPPolarity No Location NSamples=1000')
    times = []
    for i in range(n):
        starttime = time.time()
        polarity_ln_pdf(p_amplitude, error_polarity, _use_c=False)
        endtime = time.time()
        print('\tNormal time '+str(endtime-starttime))
        times.append(endtime-starttime)
    print('\nNormal Avg ', sum(times)/n)
    navg = sum(times)/n
    print('\nPPolarity No Location NSamples=1000')
    times = []
    for i in range(n):
        starttime = time.time()
        polarity_ln_pdf(p_amplitude, error_polarity, _use_c=True)
        endtime = time.time()
        print('\tCython time '+str(endtime-starttime))
        times.append(endtime-starttime)
    print('\nCython Avg ', sum(times)/n)
    print('\nRatio', n*navg/sum(times))
    print('\nPPolarity Location 200 samples NSamples=50')
    times = []
    for i in range(n):
        starttime = time.time()
        polarity_ln_pdf(x, error_polarity, _use_c=False)
        endtime = time.time()
        print('\tNormal time '+str(endtime-starttime))
        times.append(endtime-starttime)
    print('\nNormal Avg ', sum(times)/n)
    navg = sum(times)/n
    print('\nPPolarity Location 200 samples NSamples=50')
    times = []
    for i in range(n):
        starttime = time.time()
        polarity_ln_pdf(x, error_polarity, _use_c=True)
        endtime = time.time()
        times.append(endtime-starttime)
        print('\tCython time '+str(endtime-starttime))
    print('\nCython Avg ', sum(times)/n)
    print('\nRatio', n*navg/sum(times))
    print('\nAmplitude Ratio Tests\n')
    ratio = np.random.randn(a_p.shape[0], 1)
    print('\nAmplitude Ratio No Location samples NSamples=1000')
    times = []
    for i in range(n):
        starttime = time.time()
        amplitude_ratio_ln_pdf(ratio, p_amplitude, p_amplitude, 100*error_polarity, 100*error_polarity, _use_c=False)
        endtime = time.time()
        print('\tNormal time '+str(endtime-starttime))
        times.append(endtime-starttime)
    print('\nNormal Avg ', sum(times)/n)
    navg = sum(times)/n
    print('\nAmplitude Ratio No Location samples NSamples=1000')
    times = []
    for i in range(n):
        starttime = time.time()
        amplitude_ratio_ln_pdf(ratio, p_amplitude, p_amplitude, 100*error_polarity, 100*error_polarity, _use_c=True)
        endtime = time.time()
        times.append(endtime-starttime)
        print('\tCython time '+str(endtime-starttime))
    print('\nCython Avg ', sum(times)/n)
    print('\nRatio', n*navg/sum(times))
    ratio = np.random.randn(x.shape[0], 1)
    print('\nAmplitude Ratio Location 200 samples NSamples=50')
    times = []
    for i in range(n):
        starttime = time.time()
        amplitude_ratio_ln_pdf(ratio, x, x, 100*error_polarity, 100*error_polarity, _use_c=False)
        endtime = time.time()
        print('\tNormal time '+str(endtime-starttime))
        times.append(endtime-starttime)
    print('\nNormal Avg ', sum(times)/n)
    navg = sum(times)/n
    print('\nAmplitude Ratio Location 200 samples  NSamples=50')
    times = []
    for i in range(n):
        starttime = time.time()
        amplitude_ratio_ln_pdf(ratio, x, x, 100*error_polarity, 100*error_polarity, _use_c=True)
        endtime = time.time()
        times.append(endtime-starttime)
        print('\tCython time '+str(endtime-starttime))
    print('\nCython Avg ', sum(times)/n)
